(this["webpackJsonpgra-invoicer"]=this["webpackJsonpgra-invoicer"]||[]).push([[12],{475:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(5),i=a(20),r=a(26),c=a(148),s=a(38),o=(JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVERURL:"http://192.168.0.71/ReportServer_SSRS/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3",REACT_APP_VERSION:"2.0.0"}).REACT_APP_OIDC_USER)),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{isEnabled:!0,queryTag:"/?filter="},d=Object(s.a)(),b=u.isEnabled,j=(u.queryTag,function(){var t=Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get(e);case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()),p=Object(c.a)({queryKey:[t,a],queryFn:j,onSuccess:function(e){return o(e)},onError:function(e){return l(e)},enabled:b});return Object(n.a)({},p)})},479:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(5),i=a(20),r=a(26),c=a(87),s=a(248),o=a(38),l=(JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVERURL:"http://192.168.0.71/ReportServer_SSRS/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3",REACT_APP_VERSION:"2.0.0"}).REACT_APP_OIDC_USER)),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},u=Object(c.b)(),d=Object(o.a)(),b=function(){var t=Object(r.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log({postData:a}),console.log({url:e}),t.next=4,d.post(e,a);case 4:return n=t.sent,t.abrupt("return",n.data);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=Object(s.a)({mutationFn:b,onSuccess:function(e){u.invalidateQueries({queryKey:[t,""]}),a(e)},onError:function(e){return l(e)}});return Object(n.a)({},j)})},666:function(e,t,a){"use strict";a.r(t),a.d(t,"PurchaseContext",(function(){return Re}));var n=a(20),i=a(26),r=a(8),c=a(180),s=a(2),o=a.n(s),l=a(113),u=a(245),d=a(114),b=a(80),j=a(172),p=a(454),v=a(399),O=a(147),h=a(450),m=a(451),f=a(238),x=a(146),g=a(455),A=a(456),R=a(457),T=a(458),E=a(21),_=a(52),y=a(9),S=a(31),C=a(5),P=a(225),N=a(226),I=(a(251),a(255),a(246)),D=(a(252),a(115),a(475)),w=a(479),L=a(87),V=a(13),U=a(14),k=a(15),q=a(16),H=a(19),F=a(37),B=a(406),Q=function(e){Object(k.a)(a,e);var t=Object(q.a)(a);function a(e,n){var i;return Object(V.a)(this,a),(i=t.call(this)).client=e,i.queries=[],i.result=[],i.observers=[],i.observersMap={},n&&i.setQueries(n),i}return Object(U.a)(a,[{key:"onSubscribe",value:function(){var e=this;1===this.listeners.size&&this.observers.forEach((function(t){t.subscribe((function(a){e.onUpdate(t,a)}))}))}},{key:"onUnsubscribe",value:function(){this.listeners.size||this.destroy()}},{key:"destroy",value:function(){this.listeners=new Set,this.observers.forEach((function(e){e.destroy()}))}},{key:"setQueries",value:function(e,t){var a=this;this.queries=e,F.a.batch((function(){var e=a.observers,n=a.findMatchingObservers(a.queries);n.forEach((function(e){return e.observer.setOptions(e.defaultedQueryOptions,t)}));var i=n.map((function(e){return e.observer})),r=Object.fromEntries(i.map((function(e){return[e.options.queryHash,e]}))),c=i.map((function(e){return e.getCurrentResult()})),s=i.some((function(t,a){return t!==e[a]}));(e.length!==i.length||s)&&(a.observers=i,a.observersMap=r,a.result=c,a.hasListeners()&&(Object(H.a)(e,i).forEach((function(e){e.destroy()})),Object(H.a)(i,e).forEach((function(e){e.subscribe((function(t){a.onUpdate(e,t)}))})),a.notify()))}))}},{key:"getCurrentResult",value:function(){return this.result}},{key:"getQueries",value:function(){return this.observers.map((function(e){return e.getCurrentQuery()}))}},{key:"getObservers",value:function(){return this.observers}},{key:"getOptimisticResult",value:function(e){return this.findMatchingObservers(e).map((function(e){return e.observer.getOptimisticResult(e.defaultedQueryOptions)}))}},{key:"findMatchingObservers",value:function(e){var t=this,a=this.observers,n=new Map(a.map((function(e){return[e.options.queryHash,e]}))),i=e.map((function(e){return t.client.defaultQueryOptions(e)})),r=i.flatMap((function(e){var t=n.get(e.queryHash);return null!=t?[{defaultedQueryOptions:e,observer:t}]:[]})),c=new Set(r.map((function(e){return e.defaultedQueryOptions.queryHash}))),s=i.filter((function(e){return!c.has(e.queryHash)})),o=new Set(r.map((function(e){return e.observer}))),l=a.filter((function(e){return!o.has(e)})),u=function(e){var a=t.client.defaultQueryOptions(e),n=t.observersMap[a.queryHash];return null!=n?n:new B.a(t.client,a)},d=s.map((function(e,t){if(e.keepPreviousData){var a=l[t];if(void 0!==a)return{defaultedQueryOptions:e,observer:a}}return{defaultedQueryOptions:e,observer:u(e)}}));return r.concat(d).sort((function(e,t){return i.indexOf(e.defaultedQueryOptions)-i.indexOf(t.defaultedQueryOptions)}))}},{key:"onUpdate",value:function(e,t){var a=this.observers.indexOf(e);-1!==a&&(this.result=Object(H.o)(this.result,a,t),this.notify())}},{key:"notify",value:function(){var e=this;F.a.batch((function(){e.listeners.forEach((function(t){(0,t.listener)(e.result)}))}))}}]),a}(a(53).a),W=a(122),G=a(198),M=a(199),X=a(125),K=a(124);var Y=a(38),z=(a(215),a(47)),J=a(151),Z=a.n(J),$=a(83),ee=a(1);var te=function(){var e=Object(L.b)(),t=Object(Y.a)(),a=Object(z.a)(),c=a.selectedBranch,o=a.user,u=Object(s.useContext)(Re),p=(u.invoices,u.setInvoices,Object(s.useContext)(je)),h=p.formData,m=p.setFormData,f=p.gridData,g=p.setGridData,A=p.setShowNewInvoiceModal,R=p.vatAndLeviesScheme,T=p.setvatAndLeviesScheme,V=R.covidRate,U=R.cstRate,k=(R.cstWithVat,R.getfundRate),q=R.nhilRate,H=(R.regularLeviesWithVat,R.tourismRate),B=(R.trsmWithVat,R.vatRate),J=Object(s.useState)(!1),te=Object(r.a)(J,2),ae=te[0],ne=te[1],ie=Object(s.useState)([]),re=Object(r.a)(ie,2),ce=re[0],se=re[1],oe=Object(s.useState)(!1),le=Object(r.a)(oe,2),ue=le[0],de=le[1],be=Object(s.useState)([]),pe=Object(r.a)(be,2),ve=pe[0],Oe=pe[1],he=Object(s.useState)(!1),me=Object(r.a)(he,2),fe=me[0],xe=me[1],ge=Object(s.useState)(!0),Ae=Object(r.a)(ge,2),Te=Ae[0],Ee=Ae[1],_e=Object(s.useState)(!0),ye=Object(r.a)(_e,2),Se=ye[0],Ce=ye[1],Pe=Object(s.useState)(0),Ne=Object(r.a)(Pe,2),Ie=Ne[0],De=(Ne[1],Object(s.useState)([])),we=Object(r.a)(De,2),Le=we[0],Ve=we[1],Ue=Object(s.useState)("GHS"),ke=Object(r.a)(Ue,2),qe=ke[0],He=ke[1],Fe=Object(s.useState)(!1),Be=Object(r.a)(Fe,2),Qe=Be[0],We=(Be[1],Object(s.useState)(1)),Ge=Object(r.a)(We,2),Me=Ge[0],Xe=Ge[1],Ke=Object(s.useState)(1),Ye=Object(r.a)(Ke,2),ze=Ye[0],Je=Ye[1],Ze=Object(s.useState)(0),$e=Object(r.a)(Ze,2),et=$e[0],tt=$e[1],at=Object(s.useState)("".concat((new Date).getFullYear(),"-").concat((new Date).getMonth()+1,"-").concat((new Date).getDate())),nt=Object(r.a)(at,2),it=nt[0];nt[1],JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVERURL:"http://192.168.0.71/ReportServer_SSRS/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3",REACT_APP_VERSION:"2.0.0"}).REACT_APP_OIDC_USER)),Object(D.a)("/api/GetProductList/".concat(qe),"products","",(function(e){var t=e.map((function(e,t){return{name:e.name,key:t,value:e.id,code:e.code,description:e.description,price:e.price,taxRate:e.taxRate,taxable:e.taxable,trsmCst:e.trsmCst,isTaxInclusive:e.isTaxInclusive,id:e.id,status:e.status}})).filter((function(e){return"A"===e.status}));se(t)}),(function(e){})),Object(D.a)("/api/GetCompanySupplierslist/".concat(null===c||void 0===c?void 0:c.code),"suppliers","",(function(e){var t=e.filter((function(e){return"A"===e.status}));Oe(t)}),(function(e){}));var rt=Object(w.a)("/api/CreatePurchaseInvoice/".concat(null===c||void 0===c?void 0:c.code),"purchase-invoices",(function(){E.b.success("Invoice successfully saved"),xe(!1),A(!1),e.invalidateQueries({queryKey:["purchase-invoices",1,1,""]})}),(function(e){var t;E.b.error((null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)||"Invoice could not be saved. Please try again"),xe(!1)})).mutate,ct=function(){var e=Object(i.a)(Object(n.a)().mark((function e(){var t,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log({formData:h}),null!==h&&void 0!==h&&h.date){e.next=4;break}return E.b.warn("Invoice date is required"),e.abrupt("return");case 4:t={date:new Date(null===h||void 0===h?void 0:h.date).toISOString(),supplierName:h.customer,nameOfUser:null===o||void 0===o?void 0:o.name,supplierScheme:"".concat(et),transactionType:"PURCHASE",currency:h.currency,forexRate:ze,supplierTinghcard:h.identity,invoiceNo:h.invoiceNumber},Object(y.a)(t,"nameOfUser",null===o||void 0===o?void 0:o.name),Object(y.a)(t,"amount",f.reduce((function(e,t){return e+t.totalPayable}),0)),Object(y.a)(t,"ysdcid",""),Object(y.a)(t,"ysdcrecnum",h.recNum),Object(y.a)(t,"ysdcintdata",""),Object(y.a)(t,"ysdcregsig",""),Object(y.a)(t,"ysdcitems",f.length),Object(y.a)(t,"ysdcmrc",""),Object(y.a)(t,"ysdcmrctim",""),Object(y.a)(t,"ysdctime",""),Object(y.a)(t,"invoiceItems",null===f||void 0===f?void 0:f.map((function(e){return{unitPrice:null===e||void 0===e?void 0:e.price,itemDiscount:null===e||void 0===e?void 0:e.itemDiscount,quantity:null===e||void 0===e?void 0:e.quantity,vatItemId:null===e||void 0===e?void 0:e.vatItemId,isTaxable:null===e||void 0===e?void 0:e.isTaxable,isTaxInclusive:null===e||void 0===e?void 0:e.isTaxInclusive,trsmCst:null===e||void 0===e?void 0:e.trsmCst}}))),a=t,ae?(xe(!0),rt(a)):E.b.warning("Please add an item to the invoice first");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),st=function(){var e=Object(i.a)(Object(n.a)().mark((function e(a){var i,r,s,o,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=h.date?new Date(h.date).toDateString():null){e.next=4;break}return E.b.info("Select invoice date first"),e.abrupt("return");case 4:return console.log({issuedDate:i}),e.next=7,t.get("/api/checkIfRatesExist/".concat(null===c||void 0===c?void 0:c.code,"/").concat(a,"/").concat(i));case 7:(r=e.sent)&&((s=r.data).length>0?(console.log({now:s}),Je(s[0].exchangeRate),Xe("at GHS"+(null===(o=s[0])||void 0===o?void 0:o.exchangeRate)+" per "+(null===(l=s[0])||void 0===l?void 0:l.currencyCode))):(E.b.warning("There are no exchange rates set for this invoice date. Redirecting you to currency set up to add exchange rates"),setTimeout((function(){history.push("/admin/currency")}),3e3)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=Object(i.a)(Object(n.a)().mark((function e(){var a,i,r=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,t.get(a);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),lt=(function(e){var t=e.queries,a=e.context,n=Object(L.b)({context:a}),i=Object(G.a)(),c=Object(M.a)(),o=s.useMemo((function(){return t.map((function(e){var t=n.defaultQueryOptions(e);return t._optimisticResults=i?"isRestoring":"optimistic",t}))}),[t,n,i]);o.forEach((function(e){Object(K.a)(e),Object(X.a)(e,c)})),Object(X.c)(c);var l=s.useState((function(){return new Q(n,o)})),u=Object(r.a)(l,1)[0],d=u.getOptimisticResult(o);Object(W.a)(s.useCallback((function(e){return i?function(){}:u.subscribe(F.a.batchCalls(e))}),[u,i]),(function(){return u.getCurrentResult()}),(function(){return u.getCurrentResult()})),s.useEffect((function(){u.setQueries(o,{listeners:!1})}),[o,u]);var b=d.some((function(e,t){return Object(K.c)(o[t],e,i)}))?d.flatMap((function(e,t){var a=o[t],n=u.getObservers()[t];if(a&&n){if(Object(K.c)(a,e,i))return Object(K.b)(a,n,c);Object(K.d)(e,i)&&Object(K.b)(a,n,c)}return[]})):[];if(b.length>0)throw Promise.all(b);var j=u.getQueries(),p=d.find((function(e,t){var a,n;return Object(X.b)({result:e,errorResetBoundary:c,useErrorBoundary:null!=(a=null==(n=o[t])?void 0:n.useErrorBoundary)&&a,query:j[t]})}));if(null!=p&&p.error)throw p.error}({queries:[{queryKey:["purchase-products"],queryFn:function(){return ot("/api/GetProductList/".concat(qe))},enabled:Boolean(qe),cacheTime:0,onSuccess:function(e){var t=e.data;se(t)}},{queryKey:["currency-list"],queryFn:function(){return ot("/api/GetCurrency")},cacheTime:0,onSuccess:function(e){var t=e.data;Ve(t)}},{queryKey:["suppliers"],queryFn:function(){return ot("/api/GetCompanySupplierslist/".concat(null===c||void 0===c?void 0:c.code))},cacheTime:0,onSuccess:function(e){var t,a=e.data,n=a.filter((function(e){return"A"===e.status}));Oe(n),setCashCustomerTin(null===(t=a.find((function(e){return"cash customer"==e.name})))||void 0===t?void 0:t.tin)}}]}),Object($.a)("/api/GetVatAndLeviesByScheme/".concat(it,"/").concat(et),"taxScheme",et,(function(e){console.log({GetVatAndLeviesByScheme:e}),T(e)})).refetch);return Object(s.useEffect)((function(){return lt(),function(){}}),[et]),Object(ee.jsxs)(ee.Fragment,{children:[fe?Object(ee.jsx)(_.a,{}):null,Object(ee.jsxs)(j.a,{className:"bg-secondary shadow",style:{width:"42%",height:"750px"},children:[Object(ee.jsxs)(I.a,{children:[Object(ee.jsx)("div",{style:{zIndex:1e5,display:"flex",flexDirection:"roq",justifyContent:"center",alignItems:"center",position:"absolute"}}),Object(ee.jsx)(E.a,{}),Object(ee.jsxs)(v.a,{children:[Object(ee.jsx)(d.a,{style:{marginBottom:10},children:Object(ee.jsxs)(b.a,{lg:"12",children:[Object(ee.jsxs)("label",{className:"form-control-label label-mb-0",children:["Supplier ",Object(ee.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object(ee.jsx)(P.a,{suggestions:ve,formData:h,setFormData:m,businessPartner:"Supplier"})]})}),Object(ee.jsxs)(d.a,{style:{marginBottom:10},children:[Object(ee.jsxs)(b.a,{children:[Object(ee.jsx)("label",{className:"form-control-label",children:"Ghana Card / TIN "}),Object(ee.jsx)(x.a,{disabled:!0,className:"form-control font-sm",placeholder:"GHA-XXXXXXXXXXXX",value:h.identity,onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{identity:e.target.value}))},bsSize:"sm"})]}),Object(ee.jsxs)(b.a,{children:[Object(ee.jsx)("label",{className:"form-control-label",children:"VAT Type "}),Object(ee.jsxs)("select",{className:"form-control font-sm",value:et,onChange:function(e){tt(+e.target.value)},style:{height:29,padding:"0px 5px"},children:[Object(ee.jsx)("option",{value:0,children:"Standard Rate"}),Object(ee.jsx)("option",{value:1,children:"Flat Rate"})]})]})]}),Object(ee.jsxs)(d.a,{style:{marginBottom:10},children:[Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsxs)("label",{htmlFor:"invoiceDate",className:"form-control-label",children:["Invoice Date ",Object(ee.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object(ee.jsx)(Z.a,{id:"dueDate",maxDate:new Date,placeholderText:"Due date",className:"form-control font-sm",showIcon:!0,dateFormat:"yyyy/MM/dd",selected:h.date,onChange:function(e){m(Object(C.a)(Object(C.a)({},h),{},{date:e}))},style:{height:29,padding:"0px 5px"}})]}),Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsxs)("label",{className:"form-control-label ",children:["Currency ",1===Me?"":Me]}),Object(ee.jsx)("select",{className:"form-control font-sm",value:qe,onChange:function(e){He(e.target.value),"GHS"!==e.target.value?st(e.target.value):Xe("")},disabled:Qe,style:{height:29,padding:"0px 5px"},children:Le.map((function(e,t){return Object(ee.jsx)("option",{name:e.name,id:e.code,value:e.code,children:e.code},t)}))})]})]}),Object(ee.jsxs)(d.a,{style:{marginBottom:10},children:[Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsxs)("label",{className:"form-control-label ",children:["Invoice No ",Object(ee.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object(ee.jsx)(x.a,{className:"form-control font-sm",placeholder:"Invoice No.",value:h.invoiceNumber,onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{invoiceNumber:e.target.value}))},bsSize:"sm"})]}),Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsx)("label",{className:"form-control-label",children:"E-VAT Receipt No "}),Object(ee.jsx)(x.a,{className:"form-control font-sm",placeholder:"Receipt No.",value:h.recNum,onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{recNum:e.target.value}))},bsSize:"sm"})]})]}),Object(ee.jsx)(d.a,{style:{marginBottom:0},children:Object(ee.jsx)(b.a,{lg:"6",children:Object(ee.jsx)("button",{style:{backgroundColor:"transparent",border:"none"},type:"button",onClick:function(){h.customer?de(!0):E.b.warning("Please select customer first")},children:ue?null:Object(ee.jsx)("span",{"aria-hidden":!0,children:Object(ee.jsx)("h4",{children:"+ Add Item"})})})})}),ue&&Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsx)(d.a,{style:{marginBottom:10,marginTop:-20},children:Object(ee.jsxs)(b.a,{lg:"12",children:[Object(ee.jsxs)("label",{className:"form-control-label label-mb-0",htmlFor:"input-email",children:["Item",Object(ee.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object(ee.jsx)(N.a,{gridData:f,suggestions:ce,formData:h,setFormData:m,setDisabled:Ce,setIsTaxable:Ee,isPurchasing:!0})]})}),Object(ee.jsxs)(d.a,{style:{marginBottom:10},children:[Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsxs)("label",{className:"form-control-label ",htmlFor:"input-city",children:["Quantity",Object(ee.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object(ee.jsx)(x.a,{disabled:Se,className:"form-control-alternative font-sm",id:"input-city",placeholder:"Quantity",type:"number",value:null===h||void 0===h?void 0:h.quantity,min:"1",onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{quantity:e.target.value}))},onBlur:function(){return m((function(e){return Object(C.a)(Object(C.a)({},e),{},{quantity:Number(h.quantity).toFixed(4)})}))},bsSize:"sm"})]}),Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsxs)("label",{className:"form-control-label",htmlFor:"input-country",children:["Price(",null===h||void 0===h?void 0:h.currency,") ","-",h.isTaxInclusive?"Tax Incl.":"Tax Excl.",Object(ee.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object(ee.jsx)(x.a,{className:"form-control-alternative font-sm",id:"input-country",placeholder:"Price",type:"number",step:.01,value:null===h||void 0===h?void 0:h.price,min:"1",onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{price:e.target.value}))},onBlur:function(){return m((function(e){return Object(C.a)(Object(C.a)({},e),{},{price:Number(h.price).toFixed(4)})}))}})]})]}),Object(ee.jsxs)(d.a,{children:[Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsxs)(O.a,{style:{marginTop:"14px",marginBottom:0},children:[Object(ee.jsx)("input",{className:"form-control-checkbox",id:"isTaxable",type:"checkbox",checked:null===h||void 0===h?void 0:h.isTaxable,onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{isTaxable:e.target.checked}))},value:null===h||void 0===h?void 0:h.isTaxable}),"\xa0 \xa0",Object(ee.jsxs)("label",{htmlFor:"isTaxable",className:"form-control-label",children:["Is taxable?","     "]})]}),Object(ee.jsxs)(O.a,{children:[Object(ee.jsx)("input",{className:"form-control-checkbox",id:"isTaxInclusive",type:"checkbox",checked:h.isTaxInclusive,onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{isTaxInclusive:e.target.checked}))},value:null===h||void 0===h?void 0:h.isTaxInclusive}),"\xa0 \xa0",Object(ee.jsxs)("label",{htmlFor:"isTaxInclusive",className:"form-control-label",children:["Is tax inclusive?","     "]})]})]}),Object(ee.jsxs)(b.a,{lg:"6",children:[Object(ee.jsx)("label",{className:"form-control-label",htmlFor:"trsncst",children:"Tourism/CST"}),Object(ee.jsxs)("select",{className:"form-control font-sm",value:null===h||void 0===h?void 0:h.trsmCst,onChange:function(e){return m(Object(C.a)(Object(C.a)({},h),{},{trsmCst:e.target.value}))},style:{height:29,padding:"0px 5px"},children:[Object(ee.jsx)("option",{value:"NON",children:"None"}),Object(ee.jsx)("option",{value:"CST",children:"CST"}),Object(ee.jsx)("option",{value:"TRSM",children:"Tourism"})]})]})]}),Object(ee.jsxs)(d.a,{style:{marginTop:-20},children:[Object(ee.jsx)(b.a,{lg:"6",children:Object(ee.jsx)(l.a,{color:"primary",onClick:function(){return function(e){var t=0;if("NON"===e.trsmCst?t=0:"CST"===e.trsmCst?t=U/100*e.price*e.quantity:"TRSM"===e.trsmCst&&(t=H/100*e.price*e.quantity),""===e.itemName)E.b.warning("Please select an item first");else if(""===e.quantity)E.b.warning("Please provide a value for quantity");else if(""===e.price)E.b.warning("Please provide a value for price");else if(""===e.invoiceNumber)E.b.warning("Please provide a value for invoice number");else{var a={},n=0,i=0,r=0,c=!1;e.isTaxInclusive?(c=!0,a={discount:Number(Ie)||0,itemCode:e.itemCode,itemName:e.itemName,quantity:Number(e.quantity),price:Number(e.price),nhil:q/100*(e.quantity*e.price*100/121.9),getf:k/100*(e.quantity*e.price*100/121.9),covid:V/100*(e.quantity*e.price*100/121.9),otherLevies:t,vatItemId:e.vatItemId,taxableAmount:e.quantity*e.price*100/121.9},Te?i=.15*(n=a.taxableAmount+a.nhil+a.getf+a.covid):(a.nhil=0,a.getf=0,a.covid=0,n=a.taxableAmount),r=e.quantity*e.price-Ie):(a={taxable:Te,discount:Number(Ie),itemCode:e.itemCode,itemName:e.itemName,quantity:Number(e.quantity),price:Number(e.price),taxableAmount:e.quantity*e.price,nhil:q/100*e.quantity*e.price,getf:k/100*e.quantity*e.price,covid:V/100*e.quantity*e.price,otherLevies:t,vatItemId:e.vatItemId},Te?(n=a.taxableAmount+a.nhil+a.getf+a.covid,i=B/100*n):(a.nhil=0,a.getf=0,a.covid=0,n=a.taxableAmount),r=n+i+a.otherLevies-a.discount);var s=Object(C.a)(Object(C.a)({},a),{},{vatableAmt:n,vat:i,totalPayable:r,isINC:c});g((function(t){return[].concat(Object(S.a)(t),[Object(C.a)({itemName:null===e||void 0===e?void 0:e.itemName,unitPrice:null===e||void 0===e?void 0:e.price,itemDiscount:null===e||void 0===e?void 0:e.itemDiscount,quantity:null===e||void 0===e?void 0:e.quantity,vatItemId:null===e||void 0===e?void 0:e.vatItemId,isTaxable:null===e||void 0===e?void 0:e.isTaxable,isTaxInclusive:null===e||void 0===e?void 0:e.isTaxInclusive,trsmCst:null===e||void 0===e?void 0:e.trsmCst},s)])})),m(Object(C.a)(Object(C.a)({},h),{},{itemName:"",quantity:"1",price:"",isTaxable:!0,isTaxInclusive:!1,trsmCst:"NON"})),ne(!0)}}(h)},type:"button",style:{width:"100%"},size:"sm",children:"ADD ITEM"})}),Object(ee.jsx)(b.a,{lg:"6",children:(null===f||void 0===f?void 0:f.length)>0&&Object(ee.jsx)(l.a,{color:"success",type:"button",onClick:ct,style:{width:"100%"},size:"sm",children:"SUBMIT INVOICE"})})]}),Object(ee.jsx)(d.a,{})]})]})]}),Object(ee.jsx)("div",{className:"modal-footer"})]})]})},ae=a(247),ne=a(72),ie=(a(179),a(97)),re=a(59),ce=a(217),se=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return new Intl.NumberFormat(t,{minimumFractionDigits:a,maximumFractionDigits:2}).format(Number(e)?e:0)};function oe(){var e=Object(s.useContext)(je),t=e.formData,a=e.gridData,n=e.setGridData,i=e.vatAndLeviesScheme,c=Object(s.useState)(!0),o=Object(r.a)(c,2),l=(o[0],o[1],Object(s.useState)({itemName:"",quantity:0,price:0})),u=Object(r.a)(l,2),d=u[0],b=u[1],p=Object(s.useState)(!1),v=Object(r.a)(p,2),O=v[0],h=v[1],m=Object(D.a)("/api/GetCompanyName").data;JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVERURL:"http://192.168.0.71/ReportServer_SSRS/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3",REACT_APP_VERSION:"2.0.0"}).REACT_APP_OIDC_USER));return Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsxs)(j.a,{className:"shadow",style:{width:"58%",height:"750px",marginLeft:"10px",padding:"30px"},children:[Object(ee.jsxs)("div",{style:ue.header,children:[Object(ee.jsx)("div",{style:ue.leftHeader,children:Object(ee.jsx)("img",{src:ne.a,style:{height:60,width:"60%"}})}),Object(ee.jsxs)("div",{style:ue.rightHeader,children:[Object(ee.jsx)("h3",{children:m}),Object(ee.jsxs)("h4",{children:["INVOICE #: ",t.invoiceNumber]}),Object(ee.jsxs)("h4",{children:["RECEIPT #: ",t.recNum]}),Object(ee.jsxs)("h6",{children:["Issued on : ",t.issuedDate]})]})]}),Object(ee.jsxs)("div",{style:ue.title,children:[Object(ee.jsx)("h4",{children:"Invoice for"}),Object(ee.jsx)("h6",{children:t.customer})]}),Object(ee.jsx)("div",{style:ue.body,children:Object(ee.jsxs)(ae.a,{className:"table-flush",responsive:!0,children:[Object(ee.jsx)("thead",{className:"thead",children:Object(ee.jsxs)("tr",{style:{lineHeight:"10px"},children:[Object(ee.jsx)("th",{scope:"col",style:{width:"30%"},children:"Item"}),Object(ee.jsx)("th",{scope:"col",style:{width:"10%",textAlign:"right"},children:"Qty"}),Object(ee.jsx)("th",{scope:"col",style:{width:"20%",textAlign:"right"},children:"Price"}),Object(ee.jsx)("th",{scope:"col",style:{width:"20%",textAlign:"right"},children:"Amount"}),Object(ee.jsx)("th",{scope:"col",style:{width:"10%"},children:"Action"})]})}),Object(ee.jsx)("tbody",{children:a.map((function(e,t){return Object(ee.jsxs)("tr",{style:{lineHeight:"1px"},children:[Object(ee.jsx)("td",{style:{fontSize:"10px",cursor:"pointer"},title:e.itemName,children:e.itemName.substring(0,20)}),Object(ee.jsx)("td",{style:{fontSize:"10px",textAlign:"right"},children:e.quantity}),Object(ee.jsx)("td",{style:{fontSize:"10px",textAlign:"right"},children:se(e.unitPrice)}),Object(ee.jsx)("td",{style:{fontSize:"10px",textAlign:"right"},children:se(e.quantity*e.unitPrice)}),Object(ee.jsxs)("td",{style:{fontSize:"10px",textAlign:"right",cursor:"pointer"},children:[Object(ee.jsx)(ie.b,{color:"green",title:"Edit",style:{marginRight:20},onClick:function(){return function(e,t){b({index:t,itemName:e.itemName,quantity:e.quantity,price:e.price}),h(!0)}(e,t)}}),Object(ee.jsx)(re.i,{color:"darkred",title:"Remove",onClick:function(){n(a.filter((function(t,a){return t.itemCode!==e.itemCode})))}})]})]},t)}))})]})}),Object(ee.jsx)("div",{style:ue.footer,children:Object(ee.jsxs)("div",{style:ue.total,children:[Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["SUBTOTAL (EXCL) :","   ",se(a.reduce((function(e,t){return e+t.taxableAmount}),0))]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["DISCOUNT : ","   ",null!==t&&void 0!==t&&t.discountType?"general"===(null===t||void 0===t?void 0:t.discountType)?se(a.reduce((function(e,t){return e+t.discount}),0)):se(null===t||void 0===t?void 0:t.totalDiscount):"0"]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["NHIL (",i.nhilRate,"%): ","   ",se(a.reduce((function(e,t){return e+t.nhil}),0))]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["GETF (",i.getfundRate,"%):"," ",se(a.reduce((function(e,t){return e+t.getf}),0))]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["COVID19 (",i.covidRate,"%):",se(a.reduce((function(e,t){return e+t.covid}),0))," "]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["(CST: ",null===i||void 0===i?void 0:i.cstRate,"%) / (TOURISM: ",null===i||void 0===i?void 0:i.tourismRate,"%):"," ",se(a.reduce((function(e,t){return e+t.otherLevies}),0))," "]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},hidden:!0,children:["TOURISM (TOURISM",null===i||void 0===i?void 0:i.tourismRate,"%):"," ",se(a.reduce((function(e,t){return e+t.otherLevies}),0))," "]}),Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:["VAT (",null===i||void 0===i?void 0:i.vatRate,"%):",se(a.reduce((function(e,t){return e+t.vat}),0))," "]})," ",Object(ee.jsxs)("h6",{style:{padding:0,margin:0},children:[Object(ee.jsx)("hr",{className:"my-1"}),Object(ee.jsxs)("strong",{children:["TOTAL PAYABLE",":"," "]}),t.currency," ",null!==t&&void 0!==t&&t.discountType?"selective"===(null===t||void 0===t?void 0:t.discountType)?se(a.reduce((function(e,t){return e+t.totalPayable}),0)-(null===t||void 0===t?void 0:t.totalDiscount)):se(null===t||void 0===t?void 0:t.totalDiscount):se(a.reduce((function(e,t){return e+t.totalPayable}),0))]})]})})]}),O&&Object(ee.jsx)(ce.a,{updateItemData:d,setUpdateItemData:b,setShowUpdate:h,gridData:a,setGridData:n})]})}var le,ue={header:{display:"flex",height:"20%",marginBottom:20},bottomcomments:{display:"flex",justifyContent:"space-between"},leftHeader:{display:"flex",width:"50%",flexDirection:"column",alignItems:"flex-start"},rightHeader:{display:"flex",width:"50%",flexDirection:"column",alignItems:"flex-end"},title:{height:"14%",backgroundColor:"whitesmoke",borderRadius:10,padding:10,marginBottom:25},body:{marginTop:0,height:"280px",maxHeight:"280px",overflow:"auto"},footer:{display:"flex",marginTop:10,height:"30%",justifyContent:"flex-end"},total:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-end",paddingTop:10,width:"50%",height:"100%",borderTop:"1px  solid #e3e3e3"},comments:{height:100,width:"47%",overflow:"auto",flexDirection:"row",backgroundColor:"#eff4fd",borderRadius:10,padding:10,color:"#cecece",marginTop:40},tablehead:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"}},de=a(249),be=(le={customer:"",identity:"",email:"",tel:"",itemName:"",quantity:"",price:"",isTaxable:!1,vatItemId:"",invoiceNumber:"",recNum:"",issuedDate:""},Object(y.a)(le,"isTaxable",!0),Object(y.a)(le,"vatItemId",""),Object(y.a)(le,"currency",""),Object(y.a)(le,"discountType",""),Object(y.a)(le,"totalDiscount",""),Object(y.a)(le,"date",null),Object(y.a)(le,"dueDate",null),Object(y.a)(le,"itemDiscount",0),Object(y.a)(le,"quantity",""),Object(y.a)(le,"isTaxInclusive",!1),Object(y.a)(le,"trsmCst","NON"),le),je=Object(s.createContext)(null);function pe(e){var t=e.setShowNewInvoiceModal,a=Object(s.useState)(be),n=Object(r.a)(a,2),i=n[0],c=n[1],o=Object(s.useState)([]),u=Object(r.a)(o,2),d=u[0],b=u[1],j=Object(s.useState)(""),p=Object(r.a)(j,2),v=p[0],O=p[1],h=Object(s.useState)({covidRate:0,cstRate:0,cstWithVat:0,getfundRate:0,nhilRate:0,regularLeviesWithVat:0,tourismRate:0,trsmWithVat:0,vatRate:0}),m=Object(r.a)(h,2),f=m[0],x=m[1];return Object(ee.jsx)(ee.Fragment,{children:Object(ee.jsxs)(de.a,{style:{minWidth:"max-content",margin:"30px auto"},className:"modal-dialog-centered modal-xl",isOpen:!0,toggle:function(){return console.log("toggled")},children:[Object(ee.jsxs)("div",{className:"modal-header",children:[Object(ee.jsx)("h2",{className:"modal-title",id:"exampleModalLabel",children:"Record purchase invoice"}),Object(ee.jsx)(l.a,{"aria-label":"Close","data-dismiss":"modal",type:"button",onClick:function(){return t(!1)},size:"sm",children:Object(ee.jsx)("span",{"aria-hidden":!0,children:"\xd7"})})]}),Object(ee.jsx)("div",{className:"modal-body",style:{display:"flex",marginTop:-30,resize:"both",overflow:"auto"},children:Object(ee.jsxs)(je.Provider,{value:{formData:i,gridData:d,setFormData:c,setGridData:b,setShowNewInvoiceModal:t,init:be,comments:v,setComments:O,vatAndLeviesScheme:f,setvatAndLeviesScheme:x},children:[Object(ee.jsx)(te,{}),Object(ee.jsx)(oe,{})]})})]})})}var ve=a(56),Oe=a(182),he=(a(484),a(117)),me=a(116),fe=a(148),xe=a(174),ge=a(175),Ae=a(123),Re=Object(s.createContext)(),Te=(t.default=function(){var e=Object(Y.a)(),t=Object(s.useState)(!1),a=Object(r.a)(t,2),_=a[0],y=a[1],S=Object(s.useState)(!1),C=Object(r.a)(S,2),P=C[0],N=C[1],I=Object(s.useState)([]),D=Object(r.a)(I,2),w=D[0],L=D[1],V=Object(s.useState)(1),U=Object(r.a)(V,2),k=U[0],q=U[1],H=Object(s.useState)(5),F=Object(r.a)(H,1)[0],B=Object(s.useState)({totalItems:1,pageNumber:1,pageSize:5,totalPages:1}),Q=Object(r.a)(B,2),W=Q[0],G=Q[1],M=Object(s.useState)(!1),X=Object(r.a)(M,2),K=X[0],J=X[1],Z=Object(s.useState)({}),$=Object(r.a)(Z,2),te=$[0],ae=$[1],ne=Object(s.useState)(!1),ie=Object(r.a)(ne,2),ce=ie[0],se=ie[1],oe=Object(s.useState)(""),le=Object(r.a)(oe,2),ue=le[0],de=le[1],be=Object(s.useState)({totalPayable:0,totalSalesVAT:0,totalNoSalesInvoices:0}),je=Object(r.a)(be,2),Ee=je[0],_e=je[1],ye=Object(s.useState)(1),Se=Object(r.a)(ye,2),Ce=Se[0],Pe=Se[1],Ne=Object(s.useState)("Purchase"),Ie=Object(r.a)(Ne,2),De=Ie[0],we=(Ie[1],Object(s.useState)(null)),Le=Object(r.a)(we,2),Ve=Le[0],Ue=Le[1],ke=Object(s.useRef)(),qe=Object(xe.a)(ue,100),He=Object(r.a)(qe,1)[0],Fe=Object(s.useState)(null),Be=Object(r.a)(Fe,2),Qe=Be[0],We=Be[1],Ge=Object(z.a)(),Me=Ge.selectedBranch,Xe=(Ge.user,JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVERURL:"http://192.168.0.71/ReportServer_SSRS/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3",REACT_APP_VERSION:"2.0.0"}).REACT_APP_OIDC_USER)),o.a.useMemo((function(){return[{Header:"Invoice #",accessor:"invoiceNo",className:" text-left ",width:180},{Header:"Date",accessor:"date",className:" text-left ",width:140,Cell:function(e){var t=e.cell.value;return Object(ee.jsx)(ee.Fragment,{children:new Date(t).toLocaleDateString("en-GB")})}},{Header:"Supplier",accessor:"customerName",className:" text-left ",Cell:function(e){var t=e.cell.value;return Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsx)("span",{"data-tip":t,children:t}),Object(ee.jsx)(Ae.a,{})]})},width:"auto"},{Header:"Served By",accessor:"nameOfUser",className:" text-left ",Cell:function(e){var t=e.cell.value;return Object(ee.jsxs)(ee.Fragment,{children:[Object(ee.jsx)("span",{"data-tip":t,children:t}),Object(ee.jsx)(Ae.a,{})]})},width:"auto"},{Header:function(){return Object(ee.jsx)("span",{align:"right",style:{float:"right",width:"100%"},children:"Total Payable (GHS)"})},accessor:"totalAmount",className:" text-right ",Cell:function(e){var t=e.cell.value;return Object(ee.jsx)(ee.Fragment,{children:Object(ve.b)(t)})},width:"auto"},{Header:function(){return Object(ee.jsx)("div",{align:"center",children:"View"})},disableSortBy:!0,className:" text-center table-action",Cell:function(e){var t=e.row;return Object(ee.jsx)(l.a,{style:{padding:"2px 8px"},className:"badge-success",onClick:function(e){var a;We(null===t||void 0===t?void 0:t.values),Ke(null===t||void 0===t||null===(a=t.values)||void 0===a?void 0:a.id)},title:"Preview",children:Object(ee.jsx)(re.f,{})})},accessor:"id"}]}),[])),Ke=function(){var t=Object(i.a)(Object(n.a)().mark((function t(a){var i;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return J(!0),t.next=3,e.post("/api/GenerateVAPurchaseInvoiceReportAsync",a);case 3:return i=t.sent,t.abrupt("return",null===i||void 0===i?void 0:i.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ye=Object(fe.a)({queryKey:["purchase-invoice",null===Qe||void 0===Qe?void 0:Qe.id],queryFn:function(){return Ke(null===Qe||void 0===Qe?void 0:Qe.id)},enabled:Boolean(null===Qe||void 0===Qe?void 0:Qe.id),onSuccess:function(e){var t="data:application/pdf;base64,"+e;J(!1),We(null),ae(t),se(!0)},onError:function(e){J(!1),E.b.error((null===e||void 0===e?void 0:e.data)||"Error. Unable to load preview. Please try again")}}),ze=(Ye.refetch,Ye.data,Ye.isLoading,function(){var t=Object(i.a)(Object(n.a)().mark((function t(a,i){var r,c,s,o,l,u;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y(!0),r=i.length>1?"/api/GetPurchaseSearch/".concat(Ce,"/").concat(a,"/").concat(F,"/").concat(i):"/api/GetPurchase/".concat(Ce,"/").concat(a,"/").concat(F,"/").concat(null===Me||void 0===Me?void 0:Me.code),t.next=4,e.get(r);case 4:if(s=t.sent,y(!1),!(i.length>1)){t.next=16;break}return c=null===s||void 0===s?void 0:s.data,o={},(l={}).paging=1,l.items=c,o.invoices=l,o.summaries=c,t.abrupt("return",o);case 16:return c=null===s||void 0===s?void 0:s.data,G(null===(u=c.invoices)||void 0===u?void 0:u.paging),t.abrupt("return",c);case 19:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),Je=Object(fe.a)({queryKey:["purchase-invoices",k,Number(Ce),He],queryFn:function(){return ze(k,He)},onSuccess:function(e){var t,a,n;if(null===e||void 0===e||null===(t=e.invoices)||void 0===t||!t.items.length){var i="No invoices available for "+ke.current.options[ke.current.selectedIndex].innerText;return Ue(i),G({}),void L([])}L(null===(a=e.invoices)||void 0===a?void 0:a.items),G(null===(n=e.invoices)||void 0===n?void 0:n.paging),_e({totalPayable:e.totalPayable,totalSalesVAT:e.totalSalesVAT,totalNoSalesInvoices:e.totalNoSalesInvoices}),Ue(null)},onError:function(e){console.log({treat:e})}}),Ze=(Je.data,Je.refetch);Je.isFetching,Je.isLoading;return Object(s.useEffect)((function(){return Ze(),function(){}}),[Ce,k]),Object(s.useEffect)((function(){return He.length>1&&Ze(),ue&&(L([]),Ze()),function(){}}),[He]),Object(ee.jsxs)(Re.Provider,{value:{invoices:w,setInvoices:L},children:[Object(ee.jsx)(c.a,{summary:Ee,period:Ce,setPeriod:Pe,dayOfWeekSelRef:ke,pageName:"Purchase Invoice"}),Object(ee.jsx)(he.ErrorBoundary,{FallbackComponent:me.a,onError:function(e){return Object(ee.jsx)("h1",{children:"Something happened while previewing purchase"})},children:Object(ee.jsxs)(u.a,{className:"mt--7",fluid:!0,children:[Object(ee.jsx)(E.a,{}),Object(ee.jsx)(d.a,{className:"my-5",children:Object(ee.jsx)(b.a,{className:"mb-5 mb-xl-0",xl:"12",children:Object(ee.jsxs)(j.a,{className:"shadow",children:[Object(ee.jsx)(p.a,{className:"border-0",children:Object(ee.jsxs)(d.a,{className:"align-items-center",children:[Object(ee.jsx)("div",{className:"col",children:Object(ee.jsx)(v.a,{className:"navbar-search navbar-search-light form-inline ",onSubmit:function(e){e.preventDefault()},children:Object(ee.jsxs)(O.a,{className:"mb-0",children:[" ",Object(ee.jsxs)(h.a,{className:"input-group-alternative",children:[Object(ee.jsx)(m.a,{addonType:"prepend",style:{marginTop:7},children:Object(ee.jsx)(f.a,{children:Object(ee.jsx)("i",{className:"fas fa-search"})})}),Object(ee.jsx)(x.a,{placeholder:"Search Transactions by Invoice No or Customer name",type:"text",value:ue,onChange:function(e){de(e.target.value)},style:{width:400}}),Object(ee.jsx)(m.a,{addonType:"append",children:Object(ee.jsx)(f.a,{onClick:function(){return de("")}})})]})]})})}),Object(ee.jsx)("div",{className:"col text-right mt-0",children:Object(ee.jsxs)(l.a,{color:"primary",onClick:function(e){return N(!P)},size:"md",children:[Object(ee.jsx)(re.e,{})," Record Invoice"]})})]})}),Object(ee.jsx)("div",{style:Te.body,children:Object(ee.jsx)(ge.a,{isLoading:_||K,columns:Xe,data:w||[],getPrintPDF:function(){return null},message:Ve,sortKey:"date"})}),(null===W||void 0===W?void 0:W.totalItems)>0&&Object(ee.jsx)(g.a,{className:"py-4",children:Object(ee.jsx)("nav",{"aria-label":"...",children:Object(ee.jsxs)(A.a,{className:"pagination justify-content-center mb-0",listClassName:"justify-content-center mb-0",children:[Object(ee.jsx)(R.a,{children:Object(ee.jsxs)(T.a,{onClick:function(e){(null===W||void 0===W?void 0:W.pageNumber)>1&&q((function(e){return Number(e)-1}))},children:[Object(ee.jsx)("i",{className:"fas fa-angle-left"}),Object(ee.jsx)("span",{className:"sr-only",children:"Previous"})]})}),Object(ee.jsx)(R.a,{children:Object(ee.jsx)(T.a,{onClick:function(e){return q(1)},children:"1"})}),Object(ee.jsx)(R.a,{className:"active",children:Object(ee.jsx)(T.a,{onClick:function(e){return e.preventDefault()},children:null===W||void 0===W?void 0:W.pageNumber})}),Object(ee.jsx)(R.a,{children:Object(ee.jsx)(T.a,{onClick:function(e){return q(W.totalPages)},children:null===W||void 0===W?void 0:W.totalPages})}),Object(ee.jsx)(R.a,{children:Object(ee.jsxs)(T.a,{onClick:function(e){W.pageNumber<W.totalPages&&q((function(e){return Number(e)+1}))},children:[Object(ee.jsx)("i",{className:"fas fa-angle-right"}),Object(ee.jsx)("span",{className:"sr-only",children:"Next"})]})})]})})})]})})}),P?Object(ee.jsx)(pe,{setShowNewInvoiceModal:N}):null,ce&&Object(ee.jsx)(Oe.a,{setShowReport:se,pdfData:te,getPrintPDF:function(){return null},salesType:De,showSignature:!1,selectedInvoiceNo:null===Qe||void 0===Qe?void 0:Qe.invoiceNo,bottom:0})]})})]})},{body:{marginTop:0,overflow:"auto"}})}}]);