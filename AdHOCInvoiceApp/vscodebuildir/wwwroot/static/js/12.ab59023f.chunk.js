(this["webpackJsonpgra-invoicer"]=this["webpackJsonpgra-invoicer"]||[]).push([[12],{472:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(5),i=a(20),r=a(26),c=a(146),s=a(38),o=(JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER)),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{isEnabled:!0,queryTag:"/?filter="},d=Object(s.a)(),b=u.isEnabled,p=(u.queryTag,function(){var t=Object(r.a)(Object(i.a)().mark((function t(){var a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get(e);case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()),j=Object(c.a)({queryKey:[t,a],queryFn:p,onSuccess:function(e){return o(e)},onError:function(e){return l(e)},enabled:b});return Object(n.a)({},j)})},476:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(5),i=a(20),r=a(26),c=a(100),s=a(400),o=a(38),l=(JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER)),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},u=Object(c.b)(),d=Object(o.a)(),b=function(){var t=Object(r.a)(Object(i.a)().mark((function t(a){var n;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log({postData:a}),console.log({url:e}),t.next=4,d.post(e,a);case 4:return n=t.sent,t.abrupt("return",n.data);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=Object(s.a)({mutationFn:b,onSuccess:function(e){u.invalidateQueries({queryKey:[t,""]}),a(e)},onError:function(e){return l(e)}});return Object(n.a)({},p)})},662:function(e,t,a){"use strict";a.r(t),a.d(t,"PurchaseContext",(function(){return Te}));var n=a(20),i=a(26),r=a(8),c=a(179),s=a(2),o=a.n(s),l=a(165),u=a(244),d=a(110),b=a(80),p=a(171),j=a(450),O=a(394),v=a(145),h=a(446),m=a(447),f=a(237),x=a(144),A=a(451),T=a(452),g=a(453),E=a(454),_=a(21),R=a(52),C=a(9),P=a(31),y=a(5),S=a(224),N=a(225),I=(a(248),a(252),a(245)),D=(a(249),a(111),a(472)),w=a(476),L=a(100),U=a(13),V=a(14),k=a(15),H=a(16),q=a(19),F=a(37),Q=a(402),B=function(e){Object(k.a)(a,e);var t=Object(H.a)(a);function a(e,n){var i;return Object(U.a)(this,a),(i=t.call(this)).client=e,i.queries=[],i.result=[],i.observers=[],i.observersMap={},n&&i.setQueries(n),i}return Object(V.a)(a,[{key:"onSubscribe",value:function(){var e=this;1===this.listeners.size&&this.observers.forEach((function(t){t.subscribe((function(a){e.onUpdate(t,a)}))}))}},{key:"onUnsubscribe",value:function(){this.listeners.size||this.destroy()}},{key:"destroy",value:function(){this.listeners=new Set,this.observers.forEach((function(e){e.destroy()}))}},{key:"setQueries",value:function(e,t){var a=this;this.queries=e,F.a.batch((function(){var e=a.observers,n=a.findMatchingObservers(a.queries);n.forEach((function(e){return e.observer.setOptions(e.defaultedQueryOptions,t)}));var i=n.map((function(e){return e.observer})),r=Object.fromEntries(i.map((function(e){return[e.options.queryHash,e]}))),c=i.map((function(e){return e.getCurrentResult()})),s=i.some((function(t,a){return t!==e[a]}));(e.length!==i.length||s)&&(a.observers=i,a.observersMap=r,a.result=c,a.hasListeners()&&(Object(q.a)(e,i).forEach((function(e){e.destroy()})),Object(q.a)(i,e).forEach((function(e){e.subscribe((function(t){a.onUpdate(e,t)}))})),a.notify()))}))}},{key:"getCurrentResult",value:function(){return this.result}},{key:"getQueries",value:function(){return this.observers.map((function(e){return e.getCurrentQuery()}))}},{key:"getObservers",value:function(){return this.observers}},{key:"getOptimisticResult",value:function(e){return this.findMatchingObservers(e).map((function(e){return e.observer.getOptimisticResult(e.defaultedQueryOptions)}))}},{key:"findMatchingObservers",value:function(e){var t=this,a=this.observers,n=new Map(a.map((function(e){return[e.options.queryHash,e]}))),i=e.map((function(e){return t.client.defaultQueryOptions(e)})),r=i.flatMap((function(e){var t=n.get(e.queryHash);return null!=t?[{defaultedQueryOptions:e,observer:t}]:[]})),c=new Set(r.map((function(e){return e.defaultedQueryOptions.queryHash}))),s=i.filter((function(e){return!c.has(e.queryHash)})),o=new Set(r.map((function(e){return e.observer}))),l=a.filter((function(e){return!o.has(e)})),u=function(e){var a=t.client.defaultQueryOptions(e),n=t.observersMap[a.queryHash];return null!=n?n:new Q.a(t.client,a)},d=s.map((function(e,t){if(e.keepPreviousData){var a=l[t];if(void 0!==a)return{defaultedQueryOptions:e,observer:a}}return{defaultedQueryOptions:e,observer:u(e)}}));return r.concat(d).sort((function(e,t){return i.indexOf(e.defaultedQueryOptions)-i.indexOf(t.defaultedQueryOptions)}))}},{key:"onUpdate",value:function(e,t){var a=this.observers.indexOf(e);-1!==a&&(this.result=Object(q.o)(this.result,a,t),this.notify())}},{key:"notify",value:function(){var e=this;F.a.batch((function(){e.listeners.forEach((function(t){(0,t.listener)(e.result)}))}))}}]),a}(a(53).a),W=a(118),G=a(197),X=a(198),M=a(122),K=a(121);var Y=a(38),J=(a(214),a(47)),z=a(149),Z=a.n(z),$=a(1);var ee=function(){var e=Object(L.b)(),t=Object(Y.a)(),a=Object(J.a)(),c=a.selectedBranch,o=a.user,u=Object(s.useContext)(Te),j=(u.invoices,u.setInvoices,Object(s.useContext)(be)),h=j.formData,m=j.setFormData,f=j.gridData,A=j.setGridData,T=j.setShowNewInvoiceModal,g=Object(s.useState)(!1),E=Object(r.a)(g,2),U=E[0],V=E[1],k=Object(s.useState)([]),H=Object(r.a)(k,2),q=H[0],Q=H[1],z=Object(s.useState)(!1),ee=Object(r.a)(z,2),te=ee[0],ae=ee[1],ne=Object(s.useState)([]),ie=Object(r.a)(ne,2),re=ie[0],ce=ie[1],se=Object(s.useState)(!1),oe=Object(r.a)(se,2),le=oe[0],ue=oe[1],de=Object(s.useState)(!0),pe=Object(r.a)(de,2),je=pe[0],Oe=pe[1],ve=Object(s.useState)(!0),he=Object(r.a)(ve,2),me=he[0],fe=he[1],xe=Object(s.useState)(0),Ae=Object(r.a)(xe,2),ge=Ae[0],Ee=(Ae[1],Object(s.useState)([])),_e=Object(r.a)(Ee,2),Re=_e[0],Ce=_e[1],Pe=Object(s.useState)("GHS"),ye=Object(r.a)(Pe,2),Se=ye[0],Ne=ye[1],Ie=Object(s.useState)(!1),De=Object(r.a)(Ie,2),we=De[0],Le=(De[1],Object(s.useState)(1)),Ue=Object(r.a)(Le,2),Ve=Ue[0],ke=Ue[1],He=Object(s.useState)(1),qe=Object(r.a)(He,2),Fe=qe[0],Qe=qe[1],Be=Object(s.useState)(!1),We=Object(r.a)(Be,2);We[0],We[1],JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER)),Object(D.a)("/api/GetProductList/".concat(Se),"products","",(function(e){var t=e.map((function(e,t){return{name:e.name,key:t,value:e.id,code:e.code,description:e.description,price:e.price,taxRate:e.taxRate,taxable:e.taxable,trsmCst:e.trsmCst,isTaxInclusive:e.isTaxInclusive,id:e.id,status:e.status}})).filter((function(e){return"A"===e.status}));Q(t)}),(function(e){})),Object(D.a)("/api/GetCompanySuppliers","suppliers","",(function(e){var t=e.filter((function(e){return"A"===e.status}));ce(t)}),(function(e){}));var Ge=Object(w.a)("/api/CreatePurchaseInvoice/".concat(null===c||void 0===c?void 0:c.code),"purchase-invoices",(function(){_.b.success("Invoice successfully saved"),ue(!1),T(!1),e.invalidateQueries({queryKey:["purchase-invoices",1,1,""]})}),(function(e){var t;_.b.error((null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)||"Invoice could not be saved. Please try again"),ue(!1)})).mutate,Xe=function(){var e=Object(i.a)(Object(n.a)().mark((function e(){var t,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log({formData:h}),null!==h&&void 0!==h&&h.date){e.next=4;break}return _.b.warn("Invoice date is required"),e.abrupt("return");case 4:t={date:new Date(null===h||void 0===h?void 0:h.date).toISOString(),supplierName:h.customer,nameOfUser:null===o||void 0===o?void 0:o.name,transactionType:"PURCHASE",currency:h.currency,forexRate:Fe,supplierTinghcard:h.identity,invoiceNo:h.invoiceNumber},Object(C.a)(t,"nameOfUser",null===o||void 0===o?void 0:o.name),Object(C.a)(t,"amount",f.reduce((function(e,t){return e+t.totalPayable}),0)),Object(C.a)(t,"ysdcid",""),Object(C.a)(t,"ysdcrecnum",h.recNum),Object(C.a)(t,"ysdcintdata",""),Object(C.a)(t,"ysdcregsig",""),Object(C.a)(t,"ysdcitems",f.length),Object(C.a)(t,"ysdcmrc",""),Object(C.a)(t,"ysdcmrctim",""),Object(C.a)(t,"ysdctime",""),Object(C.a)(t,"invoiceItems",null===f||void 0===f?void 0:f.map((function(e){return{unitPrice:null===e||void 0===e?void 0:e.price,itemDiscount:null===e||void 0===e?void 0:e.itemDiscount,quantity:null===e||void 0===e?void 0:e.quantity,vatItemId:null===e||void 0===e?void 0:e.vatItemId,isTaxable:null===e||void 0===e?void 0:e.isTaxable,isTaxInclusive:null===e||void 0===e?void 0:e.isTaxInclusive,trsmCst:null===e||void 0===e?void 0:e.trsmCst}}))),a=t,U?(ue(!0),Ge(a)):_.b.warning("Please add an item to the invoice first");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Object(i.a)(Object(n.a)().mark((function e(a){var i,r,s,o,l;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=h.date?new Date(h.date).toDateString():null){e.next=4;break}return _.b.info("Select invoice date first"),e.abrupt("return");case 4:return console.log({issuedDate:i}),e.next=7,t.get("/api/checkIfRatesExist/".concat(null===c||void 0===c?void 0:c.code,"/").concat(a,"/").concat(i));case 7:(r=e.sent)&&((s=r.data).length>0?(console.log({now:s}),Qe(s[0].exchangeRate),ke("at GHS"+(null===(o=s[0])||void 0===o?void 0:o.exchangeRate)+" per "+(null===(l=s[0])||void 0===l?void 0:l.currencyCode))):(_.b.warning("There are no exchange rates set for this invoice date. Redirecting you to currency set up to add exchange rates"),setTimeout((function(){history.push("/admin/currency")}),3e3)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(i.a)(Object(n.a)().mark((function e(){var a,i,r=arguments;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,t.get(a);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(e){var t=e.queries,a=e.context,n=Object(L.b)({context:a}),i=Object(G.a)(),c=Object(X.a)(),o=s.useMemo((function(){return t.map((function(e){var t=n.defaultQueryOptions(e);return t._optimisticResults=i?"isRestoring":"optimistic",t}))}),[t,n,i]);o.forEach((function(e){Object(K.a)(e),Object(M.a)(e,c)})),Object(M.c)(c);var l=s.useState((function(){return new B(n,o)})),u=Object(r.a)(l,1)[0],d=u.getOptimisticResult(o);Object(W.a)(s.useCallback((function(e){return i?function(){}:u.subscribe(F.a.batchCalls(e))}),[u,i]),(function(){return u.getCurrentResult()}),(function(){return u.getCurrentResult()})),s.useEffect((function(){u.setQueries(o,{listeners:!1})}),[o,u]);var b=d.some((function(e,t){return Object(K.c)(o[t],e,i)}))?d.flatMap((function(e,t){var a=o[t],n=u.getObservers()[t];if(a&&n){if(Object(K.c)(a,e,i))return Object(K.b)(a,n,c);Object(K.d)(e,i)&&Object(K.b)(a,n,c)}return[]})):[];if(b.length>0)throw Promise.all(b);var p=u.getQueries(),j=d.find((function(e,t){var a,n;return Object(M.b)({result:e,errorResetBoundary:c,useErrorBoundary:null!=(a=null==(n=o[t])?void 0:n.useErrorBoundary)&&a,query:p[t]})}));if(null!=j&&j.error)throw j.error}({queries:[{queryKey:["purchase-products"],queryFn:function(){return Ke("/api/GetProductList/".concat(Se))},enabled:Boolean(Se),cacheTime:0,onSuccess:function(e){var t=e.data;Q(t)}},{queryKey:["currency-list"],queryFn:function(){return Ke("/api/GetCurrency")},cacheTime:0,onSuccess:function(e){var t=e.data;Ce(t)}},{queryKey:["suppliers"],queryFn:function(){return Ke("/api/GetCompanySuppliers")},cacheTime:0,onSuccess:function(e){var t,a=e.data,n=a.filter((function(e){return"A"===e.status}));ce(n),setCashCustomerTin(null===(t=a.find((function(e){return"cash customer"==e.name})))||void 0===t?void 0:t.tin)}}]}),Object($.jsxs)($.Fragment,{children:[le?Object($.jsx)(R.a,{}):null,Object($.jsxs)(p.a,{className:"bg-secondary shadow",style:{width:"42%",height:"750px"},children:[Object($.jsxs)(I.a,{children:[Object($.jsx)("div",{style:{zIndex:1e5,display:"flex",flexDirection:"roq",justifyContent:"center",alignItems:"center",position:"absolute"}}),Object($.jsx)(_.a,{}),Object($.jsxs)(O.a,{children:[Object($.jsx)(d.a,{style:{marginBottom:10},children:Object($.jsxs)(b.a,{lg:"12",children:[Object($.jsxs)("label",{className:"form-control-label label-mb-0",children:["Supplier ",Object($.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object($.jsx)(S.a,{suggestions:re,formData:h,setFormData:m,businessPartner:"Supplier"})]})}),Object($.jsx)(d.a,{style:{marginBottom:10},children:Object($.jsxs)(b.a,{lg:"12",children:[Object($.jsx)("label",{className:"form-control-label",children:"Ghana Card / TIN "}),Object($.jsx)(x.a,{disabled:!0,className:"form-control font-sm",placeholder:"GHA-XXXXXXXXXXXX",value:h.identity,onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{identity:e.target.value}))},bsSize:"sm"})]})}),Object($.jsxs)(d.a,{style:{marginBottom:10},children:[Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsxs)("label",{htmlFor:"invoiceDate",className:"form-control-label",children:["Invoice Date ",Object($.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object($.jsx)(Z.a,{id:"dueDate",maxDate:new Date,placeholderText:"Due date",className:"form-control font-sm",showIcon:!0,dateFormat:"yyyy/MM/dd",selected:h.date,onChange:function(e){m(Object(y.a)(Object(y.a)({},h),{},{date:e}))},style:{height:29,padding:"0px 5px"}})]}),Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsxs)("label",{className:"form-control-label ",children:["Currency ",1===Ve?"":Ve]}),Object($.jsx)("select",{className:"form-control font-sm",value:Se,onChange:function(e){Ne(e.target.value),"GHS"!==e.target.value?Me(e.target.value):ke("")},disabled:we,style:{height:29,padding:"0px 5px"},children:Re.map((function(e,t){return Object($.jsx)("option",{name:e.name,id:e.code,value:e.code,children:e.code},t)}))})]})]}),Object($.jsxs)(d.a,{style:{marginBottom:10},children:[Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsxs)("label",{className:"form-control-label ",children:["Invoice No ",Object($.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object($.jsx)(x.a,{className:"form-control font-sm",placeholder:"Invoice No.",value:h.invoiceNumber,onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{invoiceNumber:e.target.value}))},bsSize:"sm"})]}),Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsx)("label",{className:"form-control-label",children:"E-VAT Receipt No "}),Object($.jsx)(x.a,{className:"form-control font-sm",placeholder:"Receipt No.",value:h.recNum,onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{recNum:e.target.value}))},bsSize:"sm"})]})]}),Object($.jsx)(d.a,{style:{marginBottom:0},children:Object($.jsx)(b.a,{lg:"6",children:Object($.jsx)("button",{style:{backgroundColor:"transparent",border:"none"},type:"button",onClick:function(){h.customer?ae(!0):_.b.warning("Please select customer first")},children:te?null:Object($.jsx)("span",{"aria-hidden":!0,children:Object($.jsx)("h4",{children:"+ Add Item"})})})})}),te&&Object($.jsxs)($.Fragment,{children:[Object($.jsx)(d.a,{style:{marginBottom:10,marginTop:-20},children:Object($.jsxs)(b.a,{lg:"12",children:[Object($.jsxs)("label",{className:"form-control-label label-mb-0",htmlFor:"input-email",children:["Item",Object($.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object($.jsx)(N.a,{gridData:f,suggestions:q,formData:h,setFormData:m,setDisabled:fe,setIsTaxable:Oe,isPurchasing:!0})]})}),Object($.jsxs)(d.a,{style:{marginBottom:10},children:[Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsxs)("label",{className:"form-control-label ",htmlFor:"input-city",children:["Quantity",Object($.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object($.jsx)(x.a,{disabled:me,className:"form-control-alternative font-sm",id:"input-city",placeholder:"Quantity",type:"number",value:null===h||void 0===h?void 0:h.quantity,min:"1",onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{quantity:e.target.value}))},onBlur:function(){return m((function(e){return Object(y.a)(Object(y.a)({},e),{},{quantity:Number(h.quantity).toFixed(4)})}))},bsSize:"sm"})]}),Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsxs)("label",{className:"form-control-label",htmlFor:"input-country",children:["Price(",null===h||void 0===h?void 0:h.currency,") ","-",h.isTaxInclusive?"Tax Incl.":"Tax Excl.",Object($.jsx)("code",{style:{color:"darkred"},children:"*"})]}),Object($.jsx)(x.a,{className:"form-control-alternative font-sm",id:"input-country",placeholder:"Price",type:"number",step:.01,value:null===h||void 0===h?void 0:h.price,min:"1",onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{price:e.target.value}))},onBlur:function(){return m((function(e){return Object(y.a)(Object(y.a)({},e),{},{price:Number(h.price).toFixed(4)})}))}})]})]}),Object($.jsxs)(d.a,{children:[Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsxs)(v.a,{style:{marginTop:"14px",marginBottom:0},children:[Object($.jsx)("input",{className:"form-control-checkbox",id:"isTaxable",type:"checkbox",checked:null===h||void 0===h?void 0:h.isTaxable,onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{isTaxable:e.target.checked}))},value:null===h||void 0===h?void 0:h.isTaxable}),"\xa0 \xa0",Object($.jsxs)("label",{htmlFor:"isTaxable",className:"form-control-label",children:["Is taxable?","     "]})]}),Object($.jsxs)(v.a,{children:[Object($.jsx)("input",{className:"form-control-checkbox",id:"isTaxInclusive",type:"checkbox",checked:h.isTaxInclusive,onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{isTaxInclusive:e.target.checked}))},value:null===h||void 0===h?void 0:h.isTaxInclusive}),"\xa0 \xa0",Object($.jsxs)("label",{htmlFor:"isTaxInclusive",className:"form-control-label",children:["Is tax inclusive?","     "]})]})]}),Object($.jsxs)(b.a,{lg:"6",children:[Object($.jsx)("label",{className:"form-control-label",htmlFor:"trsncst",children:"Tourism/CST"}),Object($.jsxs)("select",{className:"form-control font-sm",value:null===h||void 0===h?void 0:h.trsmCst,onChange:function(e){return m(Object(y.a)(Object(y.a)({},h),{},{trsmCst:e.target.value}))},style:{height:29,padding:"0px 5px"},children:[Object($.jsx)("option",{value:"NON",children:"None"}),Object($.jsx)("option",{value:"CST",children:"CST"}),Object($.jsx)("option",{value:"TRSM",children:"Tourism"})]})]})]}),Object($.jsxs)(d.a,{style:{marginTop:-20},children:[Object($.jsx)(b.a,{lg:"6",children:Object($.jsx)(l.a,{color:"primary",onClick:function(){return function(e){var t=0;if("NON"===e.trsmCst?t=0:"CST"===e.trsmCst?t=.05*e.price*e.quantity:"TRSM"===e.trsmCst&&(t=.01*e.price*e.quantity),""===e.itemName)_.b.warning("Please select an item first");else if(""===e.quantity)_.b.warning("Please provide a value for quantity");else if(""===e.price)_.b.warning("Please provide a value for price");else if(""===e.invoiceNumber)_.b.warning("Please provide a value for invoice number");else{var a={},n=0,i=0,r=0,c=!1;e.isTaxInclusive?(c=!0,a={discount:Number(ge)||0,itemCode:e.itemCode,itemName:e.itemName,quantity:Number(e.quantity),price:Number(e.price),nhil:e.quantity*e.price*100/121.9*.025,getf:e.quantity*e.price*100/121.9*.025,covid:e.quantity*e.price*100/121.9*.01,otherLevies:t,vatItemId:e.vatItemId,taxableAmount:e.quantity*e.price*100/121.9},je?i=.15*(n=a.taxableAmount+a.nhil+a.getf+a.covid):(a.nhil=0,a.getf=0,a.covid=0,n=a.taxableAmount),r=e.quantity*e.price-ge):(a={taxable:je,discount:Number(ge),itemCode:e.itemCode,itemName:e.itemName,quantity:Number(e.quantity),price:Number(e.price),taxableAmount:e.quantity*e.price,nhil:.025*e.quantity*e.price,getf:.025*e.quantity*e.price,covid:.01*e.quantity*e.price,otherLevies:t,vatItemId:e.vatItemId},je?i=.15*(n=a.taxableAmount+a.nhil+a.getf+a.covid):(a.nhil=0,a.getf=0,a.covid=0,n=a.taxableAmount),r=n+i+a.otherLevies-a.discount);var s=Object(y.a)(Object(y.a)({},a),{},{vatableAmt:n,vat:i,totalPayable:r,isINC:c});A((function(t){return[].concat(Object(P.a)(t),[Object(y.a)({itemName:null===e||void 0===e?void 0:e.itemName,unitPrice:null===e||void 0===e?void 0:e.price,itemDiscount:null===e||void 0===e?void 0:e.itemDiscount,quantity:null===e||void 0===e?void 0:e.quantity,vatItemId:null===e||void 0===e?void 0:e.vatItemId,isTaxable:null===e||void 0===e?void 0:e.isTaxable,isTaxInclusive:null===e||void 0===e?void 0:e.isTaxInclusive,trsmCst:null===e||void 0===e?void 0:e.trsmCst},s)])})),m(Object(y.a)(Object(y.a)({},h),{},{itemName:"",quantity:"1",price:"",isTaxable:!0,isTaxInclusive:!1,trsmCst:"NON"})),V(!0)}}(h)},type:"button",style:{width:"100%"},size:"sm",children:"ADD ITEM"})}),Object($.jsx)(b.a,{lg:"6",children:(null===f||void 0===f?void 0:f.length)>0&&Object($.jsx)(l.a,{color:"success",type:"button",onClick:Xe,style:{width:"100%"},size:"sm",children:"SUBMIT INVOICE"})})]}),Object($.jsx)(d.a,{})]})]})]}),Object($.jsx)("div",{className:"modal-footer"})]})]})},te=a(246),ae=a(72),ne=(a(178),a(95)),ie=a(59),re=a(216),ce=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return new Intl.NumberFormat(t,{minimumFractionDigits:a,maximumFractionDigits:2}).format(Number(e)?e:0)};function se(){var e=Object(s.useContext)(be),t=e.formData,a=e.gridData,n=e.setGridData,i=Object(s.useState)(!0),c=Object(r.a)(i,2),o=(c[0],c[1],Object(s.useState)({itemName:"",quantity:0,price:0})),l=Object(r.a)(o,2),u=l[0],d=l[1],b=Object(s.useState)(!1),j=Object(r.a)(b,2),O=j[0],v=j[1],h=Object(D.a)("/api/GetCompanyName").data;JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER));return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)(p.a,{className:"shadow",style:{width:"58%",height:"750px",marginLeft:"10px",padding:"30px"},children:[Object($.jsxs)("div",{style:le.header,children:[Object($.jsx)("div",{style:le.leftHeader,children:Object($.jsx)("img",{src:ae.a,style:{height:60,width:"60%"}})}),Object($.jsxs)("div",{style:le.rightHeader,children:[Object($.jsx)("h3",{children:h}),Object($.jsxs)("h4",{children:["INVOICE #: ",t.invoiceNumber]}),Object($.jsxs)("h4",{children:["RECEIPT #: ",t.recNum]}),Object($.jsxs)("h6",{children:["Issued on : ",t.issuedDate]})]})]}),Object($.jsxs)("div",{style:le.title,children:[Object($.jsx)("h4",{children:"Invoice for"}),Object($.jsx)("h6",{children:t.customer})]}),Object($.jsx)("div",{style:le.body,children:Object($.jsxs)(te.a,{className:"table-flush",responsive:!0,children:[Object($.jsx)("thead",{className:"thead",children:Object($.jsxs)("tr",{style:{lineHeight:"10px"},children:[Object($.jsx)("th",{scope:"col",style:{width:"30%"},children:"Item"}),Object($.jsx)("th",{scope:"col",style:{width:"10%",textAlign:"right"},children:"Qty"}),Object($.jsx)("th",{scope:"col",style:{width:"20%",textAlign:"right"},children:"Price"}),Object($.jsx)("th",{scope:"col",style:{width:"20%",textAlign:"right"},children:"Amount"}),Object($.jsx)("th",{scope:"col",style:{width:"10%"},children:"Action"})]})}),Object($.jsx)("tbody",{children:a.map((function(e,t){return Object($.jsxs)("tr",{style:{lineHeight:"1px"},children:[Object($.jsx)("td",{style:{fontSize:"10px",cursor:"pointer"},title:e.itemName,children:e.itemName.substring(0,20)}),Object($.jsx)("td",{style:{fontSize:"10px",textAlign:"right"},children:e.quantity}),Object($.jsx)("td",{style:{fontSize:"10px",textAlign:"right"},children:ce(e.unitPrice)}),Object($.jsx)("td",{style:{fontSize:"10px",textAlign:"right"},children:ce(e.quantity*e.unitPrice)}),Object($.jsxs)("td",{style:{fontSize:"10px",textAlign:"right",cursor:"pointer"},children:[Object($.jsx)(ne.b,{color:"green",title:"Edit",style:{marginRight:20},onClick:function(){return function(e,t){d({index:t,itemName:e.itemName,quantity:e.quantity,price:e.price}),v(!0)}(e,t)}}),Object($.jsx)(ie.i,{color:"darkred",title:"Remove",onClick:function(){n(a.filter((function(t,a){return t.itemCode!==e.itemCode})))}})]})]},t)}))})]})}),Object($.jsx)("div",{style:le.footer,children:Object($.jsxs)("div",{style:le.total,children:[Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["SUBTOTAL :","   ",ce(a.reduce((function(e,t){return e+t.taxableAmount}),0))]}),Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["DISCOUNT : ","   ",ce(a.reduce((function(e,t){return e+t.discount}),0))]}),Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["NHIL (2.5%) : ","   ",ce(a.reduce((function(e,t){return e+t.nhil}),0))]}),Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["GETF (2.5%) :"," ",ce(a.reduce((function(e,t){return e+t.getf}),0))]}),Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["COVID19 (1%) :"," ",ce(a.reduce((function(e,t){return e+t.covid}),0))," "]}),Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["TOURISM (1%):"," ",ce(a.reduce((function(e,t){return e+t.tourism}),0))," "]}),Object($.jsxs)("h6",{style:{padding:0,margin:0},children:["VAT (",Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_VAT_RATE,"%) :"," ",ce(a.reduce((function(e,t){return e+t.vat}),0))," "]})," ",Object($.jsxs)("h6",{style:{padding:0,margin:0},children:[Object($.jsx)("hr",{className:"my-1"}),Object($.jsxs)("strong",{children:["TOTAL PAYABLE",":"," "]}),ce(a.reduce((function(e,t){return e+t.totalPayable}),0))]})]})})]}),O&&Object($.jsx)(re.a,{updateItemData:u,setUpdateItemData:d,setShowUpdate:v,gridData:a,setGridData:n})]})}var oe,le={header:{display:"flex",height:"20%",marginBottom:20},bottomcomments:{display:"flex",justifyContent:"space-between"},leftHeader:{display:"flex",width:"50%",flexDirection:"column",alignItems:"flex-start"},rightHeader:{display:"flex",width:"50%",flexDirection:"column",alignItems:"flex-end"},title:{height:"14%",backgroundColor:"whitesmoke",borderRadius:10,padding:10,marginBottom:25},body:{marginTop:0,height:"280px",maxHeight:"280px",overflow:"auto"},footer:{display:"flex",marginTop:10,height:"30%",justifyContent:"flex-end"},total:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-end",paddingTop:10,width:"50%",height:"100%",borderTop:"1px  solid #e3e3e3"},comments:{height:100,width:"47%",overflow:"auto",flexDirection:"row",backgroundColor:"#eff4fd",borderRadius:10,padding:10,color:"#cecece",marginTop:40},tablehead:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end"}},ue=a(401),de=(oe={customer:"",identity:"",email:"",tel:"",itemName:"",quantity:"",price:"",isTaxable:!1,vatItemId:"",invoiceNumber:"",recNum:"",issuedDate:""},Object(C.a)(oe,"isTaxable",!0),Object(C.a)(oe,"vatItemId",""),Object(C.a)(oe,"currency",""),Object(C.a)(oe,"discountType",""),Object(C.a)(oe,"totalDiscount",""),Object(C.a)(oe,"date",null),Object(C.a)(oe,"dueDate",null),Object(C.a)(oe,"itemDiscount",0),Object(C.a)(oe,"quantity",""),Object(C.a)(oe,"isTaxInclusive",!1),Object(C.a)(oe,"trsmCst","NON"),oe),be=Object(s.createContext)(null);function pe(e){var t=e.setShowNewInvoiceModal,a=Object(s.useState)(de),n=Object(r.a)(a,2),i=n[0],c=n[1],o=Object(s.useState)([]),u=Object(r.a)(o,2),d=u[0],b=u[1],p=Object(s.useState)(""),j=Object(r.a)(p,2),O=j[0],v=j[1];return Object($.jsx)($.Fragment,{children:Object($.jsxs)(ue.a,{style:{minWidth:"max-content",margin:"30px auto"},className:"modal-dialog-centered modal-xl",isOpen:!0,toggle:function(){return console.log("toggled")},children:[Object($.jsxs)("div",{className:"modal-header",children:[Object($.jsx)("h2",{className:"modal-title",id:"exampleModalLabel",children:"Record purchase invoice"}),Object($.jsx)(l.a,{"aria-label":"Close","data-dismiss":"modal",type:"button",onClick:function(){return t(!1)},size:"sm",children:Object($.jsx)("span",{"aria-hidden":!0,children:"\xd7"})})]}),Object($.jsx)("div",{className:"modal-body",style:{display:"flex",marginTop:-30,resize:"both",overflow:"auto"},children:Object($.jsxs)(be.Provider,{value:{formData:i,gridData:d,setFormData:c,setGridData:b,setShowNewInvoiceModal:t,init:de,comments:O,setComments:v},children:[Object($.jsx)(ee,{}),Object($.jsx)(se,{})]})})]})})}var je=a(56),Oe=a(181),ve=(a(481),a(113)),he=a(112),me=a(146),fe=a(173),xe=a(174),Ae=a(119),Te=Object(s.createContext)(),ge=(t.default=function(){var e=Object(Y.a)(),t=Object(s.useState)(!1),a=Object(r.a)(t,2),R=a[0],C=a[1],P=Object(s.useState)(!1),y=Object(r.a)(P,2),S=y[0],N=y[1],I=Object(s.useState)([]),D=Object(r.a)(I,2),w=D[0],L=D[1],U=Object(s.useState)(1),V=Object(r.a)(U,2),k=V[0],H=V[1],q=Object(s.useState)(5),F=Object(r.a)(q,1)[0],Q=Object(s.useState)({totalItems:1,pageNumber:1,pageSize:5,totalPages:1}),B=Object(r.a)(Q,2),W=B[0],G=B[1],X=Object(s.useState)(!1),M=Object(r.a)(X,2),K=M[0],z=M[1],Z=Object(s.useState)({}),ee=Object(r.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(s.useState)(!1),re=Object(r.a)(ne,2),ce=re[0],se=re[1],oe=Object(s.useState)(""),le=Object(r.a)(oe,2),ue=le[0],de=le[1],be=Object(s.useState)({totalPayable:0,totalSalesVAT:0,totalNoSalesInvoices:0}),Ee=Object(r.a)(be,2),_e=Ee[0],Re=Ee[1],Ce=Object(s.useState)(1),Pe=Object(r.a)(Ce,2),ye=Pe[0],Se=Pe[1],Ne=Object(s.useState)("Purchase"),Ie=Object(r.a)(Ne,2),De=Ie[0],we=(Ie[1],Object(s.useState)(null)),Le=Object(r.a)(we,2),Ue=Le[0],Ve=Le[1],ke=Object(s.useRef)(),He=Object(fe.a)(ue,100),qe=Object(r.a)(He,1)[0],Fe=Object(s.useState)(null),Qe=Object(r.a)(Fe,2),Be=Qe[0],We=Qe[1],Ge=Object(J.a)(),Xe=Ge.selectedBranch,Me=(Ge.user,JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER)),o.a.useMemo((function(){return[{Header:"Invoice #",accessor:"invoiceNo",className:" text-left ",width:180},{Header:"Date",accessor:"date",className:" text-left ",width:140,Cell:function(e){var t=e.cell.value;return Object($.jsx)($.Fragment,{children:new Date(t).toLocaleDateString("en-GB")})}},{Header:"Supplier",accessor:"customerName",className:" text-left ",Cell:function(e){var t=e.cell.value;return Object($.jsxs)($.Fragment,{children:[Object($.jsx)("span",{"data-tip":t,children:t}),Object($.jsx)(Ae.a,{})]})},width:"auto"},{Header:"Served By",accessor:"nameOfUser",className:" text-left ",Cell:function(e){var t=e.cell.value;return Object($.jsxs)($.Fragment,{children:[Object($.jsx)("span",{"data-tip":t,children:t}),Object($.jsx)(Ae.a,{})]})},width:"auto"},{Header:function(){return Object($.jsx)("span",{align:"right",style:{float:"right",width:"100%"},children:"Total Payable (GHS)"})},accessor:"totalAmount",className:" text-right ",Cell:function(e){var t=e.cell.value;return Object($.jsx)($.Fragment,{children:Object(je.b)(t)})},width:"auto"},{Header:function(){return Object($.jsx)("div",{align:"center",children:"View"})},disableSortBy:!0,className:" text-center table-action",Cell:function(e){var t=e.row;return Object($.jsx)(l.a,{style:{padding:"2px 8px"},className:"badge-success",onClick:function(e){var a;We(null===t||void 0===t?void 0:t.values),Ke(null===t||void 0===t||null===(a=t.values)||void 0===a?void 0:a.id)},title:"Preview",children:Object($.jsx)(ie.f,{})})},accessor:"id"}]}),[])),Ke=function(){var t=Object(i.a)(Object(n.a)().mark((function t(a){var i;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return z(!0),t.next=3,e.post("/api/GenerateVAPurchaseInvoiceReportAsync",a);case 3:return i=t.sent,t.abrupt("return",null===i||void 0===i?void 0:i.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ye=Object(me.a)({queryKey:["purchase-invoice",null===Be||void 0===Be?void 0:Be.id],queryFn:function(){return Ke(null===Be||void 0===Be?void 0:Be.id)},enabled:Boolean(null===Be||void 0===Be?void 0:Be.id),onSuccess:function(e){var t="data:application/pdf;base64,"+e;z(!1),We(null),ae(t),se(!0)},onError:function(e){z(!1),_.b.error((null===e||void 0===e?void 0:e.data)||"Error. Unable to load preview. Please try again")}}),Je=(Ye.refetch,Ye.data,Ye.isLoading,function(){var t=Object(i.a)(Object(n.a)().mark((function t(a,i){var r,c,s,o,l,u;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return C(!0),r=i.length>1?"/api/GetPurchaseSearch/".concat(ye,"/").concat(a,"/").concat(F,"/").concat(i):"/api/GetPurchase/".concat(ye,"/").concat(a,"/").concat(F,"/").concat(null===Xe||void 0===Xe?void 0:Xe.code),t.next=4,e.get(r);case 4:if(s=t.sent,C(!1),!(i.length>1)){t.next=16;break}return c=null===s||void 0===s?void 0:s.data,o={},(l={}).paging=1,l.items=c,o.invoices=l,o.summaries=c,t.abrupt("return",o);case 16:return c=null===s||void 0===s?void 0:s.data,G(null===(u=c.invoices)||void 0===u?void 0:u.paging),t.abrupt("return",c);case 19:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()),ze=Object(me.a)({queryKey:["purchase-invoices",k,Number(ye),qe],queryFn:function(){return Je(k,qe)},onSuccess:function(e){var t,a,n;if(null===e||void 0===e||null===(t=e.invoices)||void 0===t||!t.items.length){var i="No invoices available for "+ke.current.options[ke.current.selectedIndex].innerText;return Ve(i),G({}),void L([])}L(null===(a=e.invoices)||void 0===a?void 0:a.items),G(null===(n=e.invoices)||void 0===n?void 0:n.paging),Re({totalPayable:e.totalPayable,totalSalesVAT:e.totalSalesVAT,totalNoSalesInvoices:e.totalNoSalesInvoices}),Ve(null)},onError:function(e){console.log({treat:e})}}),Ze=(ze.data,ze.refetch);ze.isFetching,ze.isLoading;return Object(s.useEffect)((function(){return Ze(),function(){}}),[ye,k]),Object(s.useEffect)((function(){return qe.length>1&&Ze(),ue&&(L([]),Ze()),function(){}}),[qe]),Object($.jsxs)(Te.Provider,{value:{invoices:w,setInvoices:L},children:[Object($.jsx)(c.a,{summary:_e,period:ye,setPeriod:Se,dayOfWeekSelRef:ke,pageName:"Purchase Invoice"}),Object($.jsx)(ve.ErrorBoundary,{FallbackComponent:he.a,onError:function(e){return Object($.jsx)("h1",{children:"Something happened while previewing purchase"})},children:Object($.jsxs)(u.a,{className:"mt--7",fluid:!0,children:[Object($.jsx)(_.a,{}),Object($.jsx)(d.a,{className:"my-5",children:Object($.jsx)(b.a,{className:"mb-5 mb-xl-0",xl:"12",children:Object($.jsxs)(p.a,{className:"shadow",children:[Object($.jsx)(j.a,{className:"border-0",children:Object($.jsxs)(d.a,{className:"align-items-center",children:[Object($.jsx)("div",{className:"col",children:Object($.jsx)(O.a,{className:"navbar-search navbar-search-light form-inline ",onSubmit:function(e){e.preventDefault()},children:Object($.jsxs)(v.a,{className:"mb-0",children:[" ",Object($.jsxs)(h.a,{className:"input-group-alternative",children:[Object($.jsx)(m.a,{addonType:"prepend",style:{marginTop:7},children:Object($.jsx)(f.a,{children:Object($.jsx)("i",{className:"fas fa-search"})})}),Object($.jsx)(x.a,{placeholder:"Search Transactions by Invoice No or Customer name",type:"text",value:ue,onChange:function(e){de(e.target.value)},style:{width:400}}),Object($.jsx)(m.a,{addonType:"append",children:Object($.jsx)(f.a,{onClick:function(){return de("")}})})]})]})})}),Object($.jsx)("div",{className:"col text-right mt-0",children:Object($.jsxs)(l.a,{color:"primary",onClick:function(e){return N(!S)},size:"md",children:[Object($.jsx)(ie.e,{})," Record Invoice"]})})]})}),Object($.jsx)("div",{style:ge.body,children:Object($.jsx)(xe.a,{isLoading:R||K,columns:Me,data:w||[],getPrintPDF:function(){return null},message:Ue,sortKey:"date"})}),(null===W||void 0===W?void 0:W.totalItems)>0&&Object($.jsx)(A.a,{className:"py-4",children:Object($.jsx)("nav",{"aria-label":"...",children:Object($.jsxs)(T.a,{className:"pagination justify-content-center mb-0",listClassName:"justify-content-center mb-0",children:[Object($.jsx)(g.a,{children:Object($.jsxs)(E.a,{onClick:function(e){(null===W||void 0===W?void 0:W.pageNumber)>1&&H((function(e){return Number(e)-1}))},children:[Object($.jsx)("i",{className:"fas fa-angle-left"}),Object($.jsx)("span",{className:"sr-only",children:"Previous"})]})}),Object($.jsx)(g.a,{children:Object($.jsx)(E.a,{onClick:function(e){return H(1)},children:"1"})}),Object($.jsx)(g.a,{className:"active",children:Object($.jsx)(E.a,{onClick:function(e){return e.preventDefault()},children:null===W||void 0===W?void 0:W.pageNumber})}),Object($.jsx)(g.a,{children:Object($.jsx)(E.a,{onClick:function(e){return H(W.totalPages)},children:null===W||void 0===W?void 0:W.totalPages})}),Object($.jsx)(g.a,{children:Object($.jsxs)(E.a,{onClick:function(e){W.pageNumber<W.totalPages&&H((function(e){return Number(e)+1}))},children:[Object($.jsx)("i",{className:"fas fa-angle-right"}),Object($.jsx)("span",{className:"sr-only",children:"Next"})]})})]})})})]})})}),S?Object($.jsx)(pe,{setShowNewInvoiceModal:N}):null,ce&&Object($.jsx)(Oe.a,{setShowReport:se,pdfData:te,getPrintPDF:function(){return null},salesType:De,showSignature:!1,selectedInvoiceNo:null===Be||void 0===Be?void 0:Be.invoiceNo,bottom:0})]})})]})},{body:{marginTop:0,overflow:"auto"}})}}]);