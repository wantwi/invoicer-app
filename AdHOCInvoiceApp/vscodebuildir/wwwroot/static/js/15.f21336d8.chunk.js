(this["webpackJsonpgra-invoicer"]=this["webpackJsonpgra-invoicer"]||[]).push([[15],{666:function(e,t,c){"use strict";c.r(t);var a=c(20),n=c(26),r=c(5),s=c(8),l=c(2),i=c.n(l),o=c(244),d=c(110),j=c(80),u=c(171),h=c(450),b=c(165),O=c(245),p=c(452),x=c(453),m=c(454),g=c(172),v=c(21),f=(c(531),c(52),c(56)),A=c(146),R=(c(147),c(38)),E=c(174),C=c(31),_=c(401),y=c(145),N=c(144),T=c(451),P=c(246),S=c(148),w=c(149),D=c.n(w),I=(c(111),c(400)),k=c(47),L=c(1),U=(JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER)),{currencyName:"",iso:"",newRate:"",date:""}),F=function(e){var t=e.close,c=e.currencies,a=e.rate,n=e.refetchCurrencies,i=Object(l.useState)(a),o=Object(s.a)(i,2),p=o[0],x=o[1],m=Object(k.a)().selectedBranch,g=Object(l.useState)(!1),A=Object(s.a)(g,2),E=(A[0],A[1]),w=Object(l.useState)(!1),F=Object(s.a)(w,2),V=F[0],H=F[1],B=Object(l.useState)(c),W=Object(s.a)(B,2),Y=W[0],Q=W[1],z=Object(l.useState)([]),J=Object(s.a)(z,2),K=J[0],q=J[1],G=Object(R.a)(),M=Object(I.a)({mutationFn:function(e){G.post("/api/AddExchangeRate/"+(null===m||void 0===m?void 0:m.code),e)},onSuccess:function(){v.b.success("Exchange Rates Successfully saved"),Q([]),n(),t()},onError:function(e){console.log({error:e}),v.b.error((null===e||void 0===e?void 0:e.message)||"Rate could not be added")}}),X=M.mutate,Z=M.isLoading;console.log({currencyList:Y,rate:a});return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(_.a,{style:{maxWidth:"max-content",margin:"30px auto"},className:"modal-dialog-centered modal-lg",isOpen:!0,toggle:function(){return console.log("toggled")},children:Object(L.jsxs)("div",{className:"d-flex",style:{height:""},children:[Object(L.jsxs)(u.a,{className:"shadow",style:{height:"fit-content"},children:[Object(L.jsx)(h.a,{className:"bg-transparent",children:Object(L.jsx)("h3",{className:"mb-0",children:"Add New Rate"})}),Object(L.jsxs)(O.a,{style:{marginTop:-30},children:[Object(L.jsx)(d.a,{className:"icon-examples"}),Object(L.jsxs)(d.a,{children:[Object(L.jsx)(j.a,{lg:"6",children:Object(L.jsxs)(y.a,{children:[Object(L.jsxs)("label",{className:"form-control-label",htmlFor:"input-username",onClick:function(){return H(!V)},children:["Select Currency"," ",Object(L.jsx)("code",{style:{color:"darkred"},children:"*"}),Object(L.jsx)("i",{className:V?"fas fa-angle-down":"fas fa-angle-up"})]})," ",V?Object(L.jsx)(u.a,{style:{position:"absolute",width:"96%",zIndex:"1000",margin:0,maxHeight:"200px",overflow:"auto",boxShadow:"5px 10px 5px 0px rgba(189,189,189,0.75)"},children:null===c||void 0===c?void 0:c.map((function(e,t){var c;return Object(L.jsx)(j.a,{lg:"12",md:"3",onClick:function(){return t=e,H(!1),void x((function(e){return Object(r.a)(Object(r.a)({},e),{},{currencyName:t.name,iso:t.code})}));var t},children:Object(L.jsx)("div",{style:{padding:"10px",borderBottom:"1px solid #e3e3e3",alignContent:"center",marginTop:2,marginBottom:3,cursor:"pointer",height:29,fontSize:12},children:Object(L.jsxs)("div",{children:[Object(L.jsx)("img",{alt:e.name,src:"http://purecatamphetamine.github.io/country-flag-icons/3x2/".concat(null===e||void 0===e||null===(c=e.code)||void 0===c?void 0:c.substr(0,2),".svg"),style:{height:14,marginRight:5}}),e.code]})},t)},t)}))}):Object(L.jsx)(N.a,{className:"form-control font-sm",placeholder:"Currency",type:"text",value:null===p||void 0===p?void 0:p.currencyName,onClick:function(){return H(!0)},onChange:function(){return console.log("")}})]})}),Object(L.jsx)(j.a,{lg:"6",children:Object(L.jsxs)(y.a,{children:[Object(L.jsx)("label",{className:"form-control-label",htmlFor:"input-username",children:"Currency Code"})," ",Object(L.jsx)(N.a,{className:"form-control font-sm",placeholder:"Current Rate",type:"text",defaultValue:null===p||void 0===p?void 0:p.iso,disabled:!0})]})})]}),Object(L.jsxs)(d.a,{children:[Object(L.jsx)(j.a,{lg:"6",children:Object(L.jsxs)(y.a,{className:"rate-picker-date",children:[Object(L.jsx)("label",{className:"form-control-label",htmlFor:"input-username",style:{marginBottom:"5.6px"},children:"Exchange Rate Date"})," ",Object(L.jsx)("code",{style:{color:"darkred"},children:"*"}),Object(L.jsx)(D.a,{id:"invoiceDate",maxDate:new Date,calendarClassName:"rate-picker-date",placeholderText:"",className:"form-control font-sm",showIcon:!0,dateFormat:"yyyy/MM/dd",selected:null===p||void 0===p?void 0:p.date,onChange:function(e){x((function(t){return Object(r.a)(Object(r.a)({},t),{},{date:e})}))},style:{height:29,padding:"0px 5px",width:"100%"}})]})}),Object(L.jsx)(j.a,{lg:"6",children:Object(L.jsxs)(y.a,{children:[Object(L.jsx)("label",{className:"form-control-label",htmlFor:"input-username",children:"Exchange Rate"})," ",Object(L.jsx)("code",{style:{color:"darkred"},children:"*"}),Object(L.jsx)(N.a,{className:"form-control font-sm",placeholder:"Rate",type:"number",value:null===p||void 0===p?void 0:p.newRate,onChange:function(e){return x(Object(r.a)(Object(r.a)({},p),{},{newRate:Number(e.target.value)}))}})]})})]})]}),Object(L.jsx)(T.a,{children:Object(L.jsxs)(d.a,{children:[Object(L.jsxs)(j.a,{lg:"12",style:{display:"flex",flexDirection:"row-reverse"},children:[null!==a&&void 0!==a&&a.date?Object(L.jsx)(b.a,{size:"sm",color:"success",onClick:function(){console.log({currencyList:Y,rate:a})},children:"Update"}):Object(L.jsx)(b.a,{size:"sm",color:"success",onClick:function(){console.log({exchangeFormData:p}),""==p.newRate||""==p.currencyName||""==p.date?v.b.warning("Please make sure all required information has been filled"):(p.idx=K.length,q((function(e){return[].concat(Object(C.a)(e),[p])})),x(U),H(!1))},children:"Add"}),Object(L.jsx)(b.a,{style:{marginRight:10},onClick:t,size:"sm",children:"Cancel"})]}),Object(L.jsx)(j.a,{lg:"6"})]})})]}),K.length>0?Object(L.jsx)(j.a,{className:"order-xl-2 mb-5 mb-xl-0",xl:"7",children:Object(L.jsxs)(u.a,{className:"shadow",style:{width:"max-content"},children:[Object(L.jsx)(h.a,{className:"bg-transparent",children:Object(L.jsx)("h3",{className:"mb-0",children:" Exchange Rates"})}),Object(L.jsxs)(O.a,{style:{height:"600px"},children:[Object(L.jsx)(d.a,{className:"icon-examples"}),Object(L.jsx)(d.a,{children:Object(L.jsxs)(P.a,{className:"align-items-center  table-flush",responsive:!0,children:[Object(L.jsx)("thead",{className:"thead-light",children:Object(L.jsxs)("tr",{children:[Object(L.jsx)("th",{style:{width:"35%"},scope:"col",children:"Curency"}),Object(L.jsx)("th",{scope:"col",children:"Code"}),Object(L.jsx)("th",{scope:"col",children:"Date"}),Object(L.jsx)("th",{style:{textAlign:"right",width:"25%"},scope:"col",children:"Exchange Rate"}),Object(L.jsx)("th",{scope:"col",style:{textAlign:"right",width:"10%"},children:"Actions"})]})}),Object(L.jsx)("tbody",{children:null===K||void 0===K?void 0:K.map((function(e,t){return Object(L.jsxs)("tr",{style:{cursor:"pointer"},children:[Object(L.jsx)("td",{children:e.currencyName}),Object(L.jsx)("td",{children:e.iso}),Object(L.jsx)("td",{children:new Date(e.date).toDateString()}),Object(L.jsx)("td",{style:{textAlign:"right"},children:Object(f.b)(e.newRate)}),Object(L.jsx)("td",{style:{textAlign:"right",width:"10%"},onClick:function(){return function(e){var t=K.filter((function(t){return t.idx!==e}));q((function(){return t}))}(t)},children:Object(L.jsx)(S.a,{})})]},t)}))})]})})]}),Object(L.jsx)(T.a,{children:Object(L.jsxs)(d.a,{children:[Object(L.jsxs)(j.a,{lg:"12",style:{display:"flex",flexDirection:"row-reverse"},children:[Object(L.jsx)(b.a,{color:"success",onClick:function(){console.log({currencyListToPost:K});var e=K.map((function(e){return{currencyCode:e.iso,transactionDate:e.date,exchangeRate:e.newRate}}));X(e),E(!0)},children:Z?"Saving":"Save"}),Object(L.jsx)(b.a,{color:"warning",style:{marginRight:10},onClick:function(){Q([]),setShowForm(!1),t()},children:"Cancel"})]}),Object(L.jsx)(j.a,{lg:"6"})]})})]})}):null]})})})},V={currencyName:"",iso:"",newRate:"",date:""},H=(JSON.parse(sessionStorage.getItem(Object({NODE_ENV:"production",PUBLIC_URL:"/gra-invoicer",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORITY:"https://psl-app-vm3/evat-auth",REACT_APP_BASENAME:"/gra-invoicer",REACT_APP_ClientCorsOrigin:"https://psl-app-vm3",REACT_APP_CLIENT_ID:"evat-invoicing-ui",REACT_APP_CLIENT_ROOT:"https://psl-app-vm3/EvatApi/api/v1",REACT_APP_CLIENT_ROOT_V2:"https://psl-app-vm3/EvatApi/api/v2",REACT_APP_CLIENT_ROOT_V3:"https://psl-app-vm3/EvatApi/api/v3",REACT_APP_CLIENT_SECRET:"L#?+;@e&?7D40p0kYO93e>u}18qI7^",REACT_APP_DASHBOARD_URL:"https://reports.cimsgh.com/bi/site/site1/dashboards/7b5d6da7-6ff6-45c6-800c-fc893d09f5de/EVAT/Sec.%20GRA%20QA%20DASHBOARD?showmydashboards=1&isembed=true&hide_tool=dp&export=true%27",REACT_APP_DEFAULT_USER:"user",REACT_APP_REPORTSERVERPath:"/eVAT/eVAT_Report/",REACT_APP_REPORTSERVICEURL:"https://psl-app-vm3/EvatApi/api/v1/ReportViewer",REACT_APP_SYNCFUSSION_LICENSE:"ORg4AjUWIQA/Gnt2VFhiQlJPd11dXmJWd1p/THNYflR1fV9DaUwxOX1dQl9gSXtTfkVkWn1adHZQT2A=",REACT_APP_URL:"https://psl-app-vm3"}).REACT_APP_OIDC_USER)),function(e){e.reset;var t=Object(l.useState)(V),c=Object(s.a)(t,2),f=c[0],C=c[1],_=Object(l.useState)(!1),y=Object(s.a)(_,2),N=y[0],T=y[1],P=Object(k.a)().selectedBranch,S=Object(l.useState)(!1),w=Object(s.a)(S,2),D=(w[0],w[1],Object(l.useState)([])),I=Object(s.a)(D,2),U=(I[0],I[1],Object(R.a)()),H=Object(l.useState)({totalItems:10,pageNumber:1,pageSize:10,totalPages:5}),B=Object(s.a)(H,2),W=B[0],Y=(B[1],Object(l.useState)({currency:"all",period:0})),Q=Object(s.a)(Y,2),z=Q[0],J=Q[1],K=Object(l.useState)(1),q=Object(s.a)(K,2),G=q[0],M=q[1];console.log({pageNumber:G});var X=i.a.useMemo((function(){return[{Header:"Currency",accessor:"currencyCode",className:" text-left ",width:"auto"},{Header:"Date Added",accessor:"transactionDate",className:" text-left ",width:"auto",Cell:function(e){var t=e.cell.value;return Object(L.jsx)(L.Fragment,{children:new Date(t).toLocaleDateString("en-GB")})}},{Header:function(){return Object(L.jsx)("span",{align:"right",style:{float:"right",display:"inline-block",width:"100%"},children:"Rate"})},accessor:"exchangeRate",className:" text-right ",width:"auto"},{Header:function(){return Object(L.jsx)("div",{align:"center",children:"Status"})},accessor:"status",className:" text-center ",align:"center",width:"auto",Cell:function(e){return Object(L.jsx)("span",{style:{color:"A"===e.value?"green":"red"},children:"A"==e.value?"Active":"Inactive"})}}]}),[]),Z=function(){var e=Object(n.a)(Object(a.a)().mark((function e(){var t;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("/api/GetRates/".concat(null===P||void 0===P?void 0:P.code,"/").concat(z.currency,"/").concat(Number(z.period),"/").concat(W.pageNumber,"/").concat(W.pageSize));case 2:return t=e.sent,console.log({hey:t}),e.abrupt("return",t.data.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(n.a)(Object(a.a)().mark((function e(){var t;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.get("/api/GetCurrency");case 2:return t=e.sent,e.abrupt("return",t.data.filter((function(e){return!1===e.homeCurrency})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=Object(A.a)({queryFn:$,queryKey:"currencies"}),te=ee.data,ce=void 0===te?[]:te,ae=ee.isLoading,ne=Object(A.a)({queryKey:["currencies",z.currency,z.period],queryFn:Z,onSuccess:function(e){},enabled:Boolean(z.currency||z.period)}),re=ne.data,se=void 0===re?[]:re,le=ne.refetch;return console.log({exchangeFormData:f}),Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(g.a,{message:"Exchange Rate Setup page. Setup your currencies here",pageName:"Exchange Rate Setup"}),Object(L.jsx)(v.a,{}),Object(L.jsxs)(o.a,{className:"mt--7",fluid:!0,children:[Object(L.jsx)(d.a,{className:"mt-5",children:Object(L.jsx)(j.a,{className:"",children:Object(L.jsxs)(u.a,{className:"shadow",children:[Object(L.jsx)(h.a,{className:"bg-transparent",children:Object(L.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center"},children:[Object(L.jsxs)("div",{className:"d-flex",children:[Object(L.jsxs)("div",{children:[Object(L.jsx)("label",{htmlFor:"currency",className:"form-control-label ",children:"Currency"}),Object(L.jsxs)("select",{className:"form-control font-sm",id:"currency",value:z.currency,onChange:function(e){return J((function(t){return Object(r.a)(Object(r.a)({},t),{},{currency:e.target.value})}))},style:{height:29,padding:"0px 5px",width:"300px"},children:[Object(L.jsx)("option",{value:"all",children:"All"}),Object(L.jsx)("option",{value:"USD",children:"USD"}),Object(L.jsx)("option",{value:"EUR",children:"EUR"}),Object(L.jsx)("option",{value:"YEN",children:"YEN"})]})," "]}),Object(L.jsxs)("div",{className:"ml-2",children:[Object(L.jsx)("label",{htmlFor:"currency",className:"form-control-label ",children:"Filter by"}),Object(L.jsxs)("select",{className:"form-control font-sm",id:"currency",value:z.period,onChange:function(e){return J((function(t){return Object(r.a)(Object(r.a)({},t),{},{period:e.target.value})}))},style:{height:29,padding:"0px 5px",width:"300px"},children:[Object(L.jsx)("option",{value:"0",children:"Current"}),Object(L.jsx)("option",{value:"1",children:"This Week"}),Object(L.jsx)("option",{value:"2",children:"This Month"}),Object(L.jsx)("option",{value:"3",children:"This Year"}),Object(L.jsx)("option",{value:"4",children:"All Transactions"})]})," "]})]}),Object(L.jsx)(b.a,{color:"primary",onClick:function(){return T(!0)},type:"button",size:"sm",children:"Add Rate"})]})}),Object(L.jsxs)(O.a,{style:{marginTop:-30},children:[Object(L.jsx)(E.a,{isLoading:ae,columns:X,data:se}),(null===se||void 0===se?void 0:se.length)>0&&Object(L.jsxs)(p.a,{className:"pagination justify-content-center mb-0",listClassName:"justify-content-center mb-0",children:[Object(L.jsx)(x.a,{children:Object(L.jsxs)(m.a,{onClick:function(e){e.preventDefault(),W.pageNumber>1&&(G<1||M((function(e){return Number(e)-1})))},children:[Object(L.jsx)("i",{className:"fas fa-angle-left"}),Object(L.jsx)("span",{className:"sr-only",children:"Previous"})]})}),Object(L.jsx)(x.a,{children:Object(L.jsx)(m.a,{onClick:function(e){return M(1)},children:"1"})}),Object(L.jsx)(x.a,{className:"active",children:Object(L.jsx)(m.a,{onClick:function(e){return e.preventDefault()},children:W.pageNumber})}),Object(L.jsx)(x.a,{children:Object(L.jsx)(m.a,{onClick:function(e){return M(W.totalPages)},children:W.totalPages})}),Object(L.jsx)(x.a,{children:Object(L.jsxs)(m.a,{onClick:function(e){W.pageNumber<W.totalPages&&G!==W.totalPages&&M((function(e){return Number(e)+1}))},children:[Object(L.jsx)("i",{className:"fas fa-angle-right"}),Object(L.jsx)("span",{className:"sr-only",children:"Next"})]})})]})]})]})})}),N&&Object(L.jsx)(F,{rate:f,currencies:ce,close:function(){T(!1),C(V)},refetchCurrencies:le})]})]})});t.default=function(){var e=Object(l.useState)(""),t=Object(s.a)(e,2),c=t[0],a=t[1];return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)(H,{reset:a},c)})}}}]);